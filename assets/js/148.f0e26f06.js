(window.webpackJsonp=window.webpackJsonp||[]).push([[148],{473:function(s,t,a){"use strict";a.r(t);var e=a(7),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"使用场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用场景"}},[s._v("#")]),s._v(" 使用场景")]),s._v(" "),t("p",[s._v("开发过程中，本地通常会有无数次 commit ，可以合并“相同功能”的多个 commit，以保持历史的简洁。")]),s._v(" "),t("h2",{attrs:{id:"git-rebase"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#git-rebase"}},[s._v("#")]),s._v(" git rebase")]),s._v(" "),t("p",[s._v("命令使用")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" rebase "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--help")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从HEAD版本开始往过去数3个版本")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" rebase "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" HEAD~3\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 合并指定版本号（不包含此版本）")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" rebase "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("commitid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("p",[s._v("说明：")]),s._v(" "),t("blockquote",[t("ul",[t("li",[s._v("-i（--interactive）：弹出交互式的界面进行编辑合并")]),s._v(" "),t("li",[s._v("[commitid]：要合并多个版本之前的版本号，注意：[commitid] "),t("strong",[s._v("本身不参与合并")])])])]),s._v(" "),t("p",[s._v("例如，如下例子中你想合并前 5 个 commit, 那么命令指定的 commitid 为 "),t("code",[s._v("1d795e6")]),s._v("，即 "),t("code",[s._v("git rebase -i 1d795e6")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" log "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--oneline")]),s._v("\n291e427 update website\n8c8f3f4 update website\n1693a6f update clear-logs.sh version\n3759b84 update clear-logs.sh\nfc36a2a "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" links\n1d795e6 fix "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" update clear-logs.sh "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".2\n9536dab "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" dingtalk script\n3a51aaa fix "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("shellcheck")]),s._v(" problem\n2db6ad3 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("clear")]),s._v(" logs scripts\ne57b0e6 fix "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" batch del\n17cb931 fix "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" batch del\ncf7e875 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" redis script\nfe4bbcb Initial commit\n")])])]),t("p",[s._v("使用该命令之后会进入一个交互式的界面进行编辑合并，该页面中的第一列表示指令：")]),s._v(" "),t("blockquote",[t("ul",[t("li",[s._v("p, pick = use commit")]),s._v(" "),t("li",[s._v("r, reword = use commit, but edit the commit message")]),s._v(" "),t("li",[s._v("e, edit = use commit, but stop for amending")]),s._v(" "),t("li",[s._v("s, squash = use commit, but meld into previous commit")]),s._v(" "),t("li",[s._v('f, fixup = like "squash", but discard this commit\'s log message')]),s._v(" "),t("li",[s._v("x, exec = run command (the rest of the line) using shell")]),s._v(" "),t("li",[s._v("d, drop = remove commit")])])]),s._v(" "),t("h2",{attrs:{id:"合并步骤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#合并步骤"}},[s._v("#")]),s._v(" 合并步骤")]),s._v(" "),t("ol",[t("li",[s._v("查看 log 记录，使用 "),t("code",[s._v("git rebase -i [commitid]")]),s._v(" 选择要合并的 "),t("code",[s._v("commit")])]),s._v(" "),t("li",[s._v("编辑要合并的版本信息，保存提交，多条合并会出现多次（可能会出现冲突）")]),s._v(" "),t("li",[s._v("修改注释信息后，保存提交，多条合并会出现多次")]),s._v(" "),t("li",[s._v("推送远程仓库或合并到主干分支、")])]),s._v(" "),t("h3",{attrs:{id:"_1-查看-log"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-查看-log"}},[s._v("#")]),s._v(" 1. 查看 log")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" log "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--oneline")]),s._v("\n291e427 update website\n8c8f3f4 update website\n1693a6f update clear-logs.sh version\n3759b84 update clear-logs.sh\nfc36a2a "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" links\n1d795e6 fix "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" update clear-logs.sh "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".2\n9536dab "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" dingtalk script\n3a51aaa fix "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("shellcheck")]),s._v(" problem\n2db6ad3 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("clear")]),s._v(" logs scripts\ne57b0e6 fix "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" batch del\n17cb931 fix "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" batch del\ncf7e875 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" redis script\nfe4bbcb Initial commit\n")])])]),t("h3",{attrs:{id:"_2-交互页面编辑合并版本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-交互页面编辑合并版本"}},[s._v("#")]),s._v(" 2. 交互页面编辑合并版本")]),s._v(" "),t("p",[s._v("例如，执行 "),t("code",[s._v("git rebase -i [commitid]")]),s._v(" 命令之后会跳出如下内容，注意显示的内容是倒序的最老的提交在最上面，最新的在最下面")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定要合并版本号，cf7e875 不参与合并，进入 vi 编辑器")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" rebase "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" cf7e875 \npick 17cb931 fix "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" batch del\npick e57b0e6 fix "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" batch del\npick 2db6ad3 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("clear")]),s._v(" logs scripts\npick 3a51aaa fix "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("shellcheck")]),s._v(" problem\npick 9536dab "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" dingtalk script\npick 1d795e6 fix "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" update clear-logs.sh "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".2\npick fc36a2a "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" links\npick 3759b84 update clear-logs.sh\npick 1693a6f update clear-logs.sh version\npick 8c8f3f4 update website\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Rebase cf7e875..291e427 onto cf7e875 (10 commands)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Commands:")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# p, pick = use commit")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# r, reword = use commit, but edit the commit message")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# e, edit = use commit, but stop for amending")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# s, squash = use commit, but meld into previous commit")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# f, fixup = like "squash", but discard this commit\'s log message')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# x, exec = run command (the rest of the line) using shell")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# d, drop = remove commit")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# These lines can be re-ordered; they are executed from top to bottom.")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# If you remove a line here THAT COMMIT WILL BE LOST.")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# However, if you remove everything, the rebase will be aborted.")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Note that empty commits are commented out")]),s._v("\n")])])]),t("p",[s._v("根据需求修改第一列的指令，对版本进行合并")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("pick 17cb931 fix "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" batch del\nf e57b0e6 fix "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" batch del "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把 e57b0e6 合并到 17cb931，且不保留注释")]),s._v("\npick 2db6ad3 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("clear")]),s._v(" logs scripts\npick 3a51aaa fix "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("shellcheck")]),s._v(" problem\npick 9536dab "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" dingtalk script\npick 1d795e6 fix "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" update clear-logs.sh "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".2\npick fc36a2a "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" linkss\npick 3759b84 update clear-logs.sh\ns 1693a6f update clear-logs.sh version\ns 8c8f3f4 update website "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把 8c8f3f4 和 1693a6f 合并到 3759b84")]),s._v("\n")])])]),t("p",[s._v("修改完成之后，"),t("code",[s._v(":wq")]),s._v(" 保持退出。保存退出后，又弹出一个新的框，让我们更改commit信息，编辑完后退出就好了。")]),s._v(" "),t("h3",{attrs:{id:"_3-查看合并后的-log"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-查看合并后的-log"}},[s._v("#")]),s._v(" 3. 查看合并后的 log")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("4c2316c update clear-logs.sh\n73f082e "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" links\n56adcf2 fix "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" update clear-logs.sh "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".2\nebf3786 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" dingtalk script\n6e81ea7 fix "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("shellcheck")]),s._v(" problem\n64ca58f "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("clear")]),s._v(" logs scripts\n9327def fix "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" batch del\ncf7e875 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" redis script\nfe4bbcb Initial commit\n")])])]),t("h3",{attrs:{id:"_4-推送远程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-推送远程"}},[s._v("#")]),s._v(" 4. 推送远程")]),s._v(" "),t("p",[s._v("首先，"),t("code",[s._v("git pull")]),s._v(" 拉取与远程仓库同步，养成先pull最新代码再修改的好习惯；在修改本地代码前，先使用git pull拉取远程最新代码，然后再进行修改（推荐--rebase）")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" pull 远程仓库名 远程分支名 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--rebase")]),s._v("\n")])])]),t("p",[s._v("然后，"),t("code",[s._v("git push")]),s._v(" 推送，合并后 commitid 发生了变化，git 不允许 push 改变提交历史的操作，可以新增或者减少 commit 但不能改变原来的commit 历史，因此会报冲突。")]),s._v(" "),t("p",[s._v("在确认代码无误的情况下，直接使用 "),t("code",[s._v("--force")]),s._v(" 强制推送")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push 远程仓库名 远程分支名 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--force")]),s._v("\n")])])]),t("p",[s._v("在 "),t("code",[s._v("git rebase")]),s._v(" 过程中，可能会存在冲突，此时就需要解决冲突。")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看冲突")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" status\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解决冲突之后，本地提交")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rebase 继续")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" rebase "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--continue")]),s._v("\n")])])]),t("h2",{attrs:{id:"gitlens"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gitlens"}},[s._v("#")]),s._v(" GitLens")]),s._v(" "),t("p",[s._v("如果你的 VSCode 安装了 GitLens 插件，这一切都可以变得很简单")]),s._v(" "),t("p",[s._v("如下图所示：")]),s._v(" "),t("ul",[t("li",[s._v("首先点击侧边栏的版本控制按钮，")]),s._v(" "),t("li",[s._v("然后，打开 Commits 栏，在该栏目中可以选择 Undo Commit 撤销提交")]),s._v(" "),t("li",[s._v("接着，在本地暂存区 Stage 中就可以看到撤销的提交；选择需要合并冲突或者要修改的文件点击 Unstage，这些文件就会从暂存区撤回到工作区 Changes，这样就可以进行修改了；")]),s._v(" "),t("li",[s._v("最后，修改完成之后，将不同的 Commit 修改合并成一个 Commit 提交")])]),s._v(" "),t("img",{staticClass:"no-zoom",staticStyle:{margin:"0 auto"},attrs:{src:s.$withBase("/picture/04.开发工具/01.Git 学习笔记/10.Git 常用技巧/gitlens.png"),alt:"gitlens"}}),s._v(" "),t("hr"),s._v(" "),t("p",[t("strong",[s._v("reference:")])]),s._v(" "),t("blockquote",[t("ul",[t("li",[s._v("https://cloud.tencent.com/developer/article/1690638")]),s._v(" "),t("li",[s._v("https://zhuanlan.zhihu.com/p/139321091")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);