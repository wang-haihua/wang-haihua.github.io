(window.webpackJsonp=window.webpackJsonp||[]).push([[139],{464:function(t,s,a){"use strict";a.r(s);var n=a(7),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"_01-gdb-基础调试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_01-gdb-基础调试"}},[t._v("#")]),t._v(" 01 GDB 基础调试")]),t._v(" "),s("blockquote",[s("p",[t._v("reference:")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/357067993",target:"_blank",rel:"noopener noreferrer"}},[t._v("学习使用 GDB 调试代码 | Linux 中国 - 知乎 (zhihu.com)"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/297925056",target:"_blank",rel:"noopener noreferrer"}},[t._v("GDB使用详解 - 知乎 (zhihu.com)"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.sourceware.org/gdb/documentation/",target:"_blank",rel:"noopener noreferrer"}},[t._v("GDB Documentation"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.jianshu.com/p/8fc05dbf777e",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用 GDB 调试多进程程序 - 简书"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("​ GDB 全称“GNU symbolic debugger”是 Linux 下常用的程序调试器，当下的 GDB 支持调试多种编程语言编写的程序，包括 C、C++、Go、Objective-C、OpenCL、Ada 等。")]),t._v(" "),s("h2",{attrs:{id:"_1-1-基础使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-基础使用"}},[t._v("#")]),t._v(" 1.1 基础使用")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("安装工具")])])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装 gcc")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" gcc\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装 g++")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" gcc-c++ \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装 gdb")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" gdb\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[s("strong",[t._v("编译程序")])])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("gcc "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-g")]),t._v(" basic.c "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-o")]),t._v(" basic\n")])])]),s("p",[t._v("使用GDB调试程序，编译程序的过程中需要注意以下两点：")]),t._v(" "),s("ol",[s("li",[t._v("要使用GDB调试某个程序，该程序编译时需要加上编译选项 "),s("strong",[s("code",[t._v("-g")])]),t._v("，否则编译生成的程序是不包含调试信息的；")]),t._v(" "),s("li",[t._v("GCC编译器支持 "),s("strong",[s("code",[t._v("-O")])]),t._v(" 和 "),s("strong",[s("code",[t._v("-g")])]),t._v(" 一起参与编译，关闭编译器的程序优化选项。GCC编译过程对进行优化的程度分为5个等级：-O/O0, -O1, -O2, -O3, -Os，调试时一般选择默认选项 -O 不做任何优化。")])]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("调试信息")]),t._v("：reference: "),s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/141233227",target:"_blank",rel:"noopener noreferrer"}},[t._v("GDB调试信息与调试原理 - 知乎 (zhihu.com)"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("如果编译命令中不加 -g 选项，在编译后的程序中不会保留调试符号信息。")]),t._v(" "),s("p",[t._v("加不加该选项在启用 GDB 调试时存在明显区别")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("gdb basic\n")])])]),s("p",[t._v("（1）不加 -g 选项，尾行打印内容为")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Reading symbols from basic...(No debugging symbols found in basic)\n")])])]),s("p",[t._v("（2）加 -g 选项，尾行打印内容为")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Reading symbols from basic...\n")])])]),s("p",[t._v("可以看到，不加 -g 选项会直接提示程序不包含调试信息 "),s("code",[t._v("No debugging symbols found in basic")])])]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[s("strong",[t._v("启动 GDB 调试")])])]),t._v(" "),s("p",[t._v("GDB调试主要有三种方式：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("直接调试目标程序：gdb ./basic")])]),t._v(" "),s("li",[s("p",[t._v("附加进程id：gdb attach pid")])]),t._v(" "),s("li",[s("p",[t._v("调试core文件：gdb filename corename")])])]),t._v(" "),s("ol",{attrs:{start:"4"}},[s("li",[s("strong",[t._v("退出 GDB 调试")])])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("可以用命令：q（quit的缩写）或者 Ctr + d 退出 GDB。")])]),t._v(" "),s("li",[s("p",[t._v("如果GDB attach某个进程，退出GDB之前要用命令 detach 解除附加进程。")])])]),t._v(" "),s("h2",{attrs:{id:"_1-2-常用命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-常用命令"}},[t._v("#")]),t._v(" 1.2 常用命令")]),t._v(" "),s("blockquote",[s("p",[t._v("本节内容转自："),s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/297925056",target:"_blank",rel:"noopener noreferrer"}},[t._v("GDB使用详解 - 知乎 (zhihu.com)"),s("OutboundLink")],1)])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("命令名称")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("命令缩写")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("命令说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("run")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("r")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("运行一个待调试的程序")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("continue")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("c")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("让暂停的程序继续运行")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("next")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("n")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("运行到下一行")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("step")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("s")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("单步执行，遇到函数会进入")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("until")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("u")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("运行到指定行停下来")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("finish")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("fi")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("结束当前调用函数，回到上一层调用函数处")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("return")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("return")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("结束当前调用函数并返回指定值，到上一层函数调用处")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("jump")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("j")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("将当前程序执行流跳转到指定行或地址")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("print")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("p")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("打印变量或寄存器值")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("backtrace")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("bt")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("查看当前线程的调用堆栈")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("frame")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("f")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("切换到当前调用线程的指定堆栈")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("thread")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("thread")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("切换到指定线程")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("break")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("b")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("添加断点")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("tbreak")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("tb")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("添加临时断点")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("delete")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("d")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("删除断点")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("enable")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("enable")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("启用某个断点")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("disable")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("disable")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("禁用某个断点")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("watch")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("watch")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("监视某一个变量或内存地址的值是否发生变化")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("list")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("l")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("显示源码")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("info")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("i")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("查看断点 / 线程等信息")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("ptype")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("ptype")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("查看变量类型")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("disassemble")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("dis")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("查看汇编代码")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("set args")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("set args")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("设置程序启动命令行参数")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("show args")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("show args")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("查看设置的命令行参数")])])])]),t._v(" "),s("p",[t._v("一般调试中最为常用的命令，gdb 语法糖直接回车重复执行上一条命令。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("命令名称")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("命令缩写")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("命令说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("break")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("b")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("添加断点")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("run")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("r")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("运行一个待调试的程序")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("next")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("n")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("运行到下一行（步过）")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("step")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("s")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("单步执行，遇到函数会进入（步入）")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("print")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("p")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("打印变量或寄存器值")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("list")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("l")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("显示当前正在执行代码位置附近的代码")])])])]),t._v(" "),s("ol",[s("li",[s("p",[t._v("break 打断点")]),t._v(" "),s("blockquote",[s("ul",[s("li",[s("strong",[t._v("break FunctionName")]),t._v("，在函数的入口处添加一个断点；")]),t._v(" "),s("li",[s("strong",[t._v("break LineNo")]),t._v("，在"),s("strong",[t._v("当前文件")]),t._v("行号为"),s("strong",[t._v("LineNo")]),t._v("处添加断点；")]),t._v(" "),s("li",[s("strong",[t._v("break FileName:LineNo")]),t._v("，在"),s("strong",[t._v("FileName")]),t._v("文件行号为"),s("strong",[t._v("LineNo")]),t._v("处添加一个断点；")]),t._v(" "),s("li",[s("strong",[t._v("break FileName:FunctionName")]),t._v("，在"),s("strong",[t._v("FileName")]),t._v("文件的"),s("strong",[t._v("FunctionName")]),t._v("函数的入口处添加断点；")]),t._v(" "),s("li",[s("strong",[t._v("break -/+offset")]),t._v("，在当前程序暂停位置的前/后 offset 行处下断点；")]),t._v(" "),s("li",[s("strong",[t._v("break ... if cond")]),t._v("，下条件断点；")])])])]),t._v(" "),s("li",[s("p",[t._v("run 运行程序")]),t._v(" "),s("blockquote",[s("p",[t._v("启用GDB调试只是附加了一个调试文件，并没有启动这个程序，需要输入run命令（简写为r）启动这个程序")])])]),t._v(" "),s("li",[s("p",[t._v("next/step 步过/步入")]),t._v(" "),s("blockquote",[s("ul",[s("li",[s("p",[s("strong",[t._v("next")]),t._v(" 是 单步步过（step over），即遇到函数直接跳过，不进入函数内部。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("step")]),t._v(" 是 单步步入（step into），即遇到函数会进入函数内部。")])])])])]),t._v(" "),s("li",[s("p",[t._v("print 查看变量值")]),t._v(" "),s("blockquote",[s("ul",[s("li",[s("strong",[t._v("print param")]),t._v("，用于在调试过程中查看变量的值；")]),t._v(" "),s("li",[s("strong",[t._v("print param=value")]),t._v("，用于在调试过程中修改变量的值；")]),t._v(" "),s("li",[s("strong",[t._v("print a+b+c")]),t._v("，可以进行一定的表达式计算，这里是计算a、b、c三个变量之和；")]),t._v(" "),s("li",[s("strong",[t._v("print func()")]),t._v("，输出"),s("code",[t._v("func")]),t._v("函数执行的结果，常见的用途是打印系统函数执行失败原因："),s("code",[t._v("print strerror(errno)")]),t._v("；")]),t._v(" "),s("li",[t._v("*"),s("em",[t._v("print "),s("em",[t._v("this")])]),t._v("，在c++对象中，可以输出当前对象的各成员变量的值；")]),t._v(" "),s("li",[s("strong",[t._v("print arrname@arrlen")]),t._v("，输出数组 arrname")])])])]),t._v(" "),s("li",[s("p",[t._v("list 显示源码上下文")]),t._v(" "),s("blockquote",[s("ul",[s("li",[s("p",[s("strong",[t._v("list")]),t._v("，输出上一次list命令显示的代码后面的代码，如果是第一次执行list命令，则会显示当前正在执行代码位置附近的代码；")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("list -")]),t._v("，带一个减号，显示上一次list命令显示的代码前面的代码；")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("list LineNo")]),t._v("，显示当前代码文件第 "),s("strong",[t._v("LineNo")]),t._v(" 行附近的代码；")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("list FileName:LineNo")]),t._v("，显示 "),s("strong",[t._v("FileName")]),t._v(" 文件第 "),s("strong",[t._v("LineNo")]),t._v(" 行附近的代码；")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("list FunctionName")]),t._v("，显示当前文件的 "),s("strong",[t._v("FunctionName")]),t._v(" 函数附近的代码；")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("list FileName:FunctionName")]),t._v("，显示 "),s("strong",[t._v("FileName")]),t._v(" 文件的 "),s("strong",[t._v("FunctionName")]),t._v(" 函数附件的代码；")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("list from,to")]),t._v("，其中"),s("strong",[t._v("from")]),t._v("和"),s("strong",[t._v("to")]),t._v("是具体的代码位置，显示这之间的代码；")])])]),t._v(" "),s("p",[s("strong",[t._v("list")]),t._v("命令默认只会输出 "),s("strong",[t._v("10")]),t._v(" 行源代码，也可以使用如下命令修改：")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("show listsize")]),t._v("，查看 "),s("strong",[t._v("list")]),t._v(" 命令显示的代码行数；")]),t._v(" "),s("li",[s("strong",[t._v("set listsize count")]),t._v("，设置 "),s("strong",[t._v("list")]),t._v(" 命令显示的代码行数为 "),s("strong",[t._v("count")]),t._v(";")])])])])]),t._v(" "),s("h2",{attrs:{id:"_1-3-gdb-基础调试实例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-gdb-基础调试实例"}},[t._v("#")]),t._v(" 1.3 GDB 基础调试实例")]),t._v(" "),s("p",[t._v("下面结合一个例子熟悉常用的 gdb 调试命令，例子如下：")]),t._v(" "),s("p",[t._v("代码定义了一个静态整型变量"),s("code",[t._v("param")]),t._v("，并初始化为1。")]),t._v(" "),s("p",[t._v("然后定义了两个分别名为"),s("code",[t._v("func1")]),t._v("和"),s("code",[t._v("func2")]),t._v("的函数，它接收两个参数 "),s("code",[t._v("var")]),t._v("和"),s("code",[t._v("val")]),t._v("，并试图在 将 "),s("code",[t._v("var")]),t._v("的值修改为"),s("code",[t._v("val")]),t._v("。但是"),s("code",[t._v("func1")]),t._v("中"),s("strong",[t._v("形参是值传递")]),t._v("，函数外部无法实现参数值的修改；"),s("code",[t._v("func2")]),t._v("中"),s("strong",[t._v("形参是引用传递")]),t._v("，能够完成参数值修改。")]),t._v(" "),s("p",[t._v("最后定义了主函数"),s("code",[t._v("main")]),t._v("，调用"),s("code",[t._v("func")]),t._v("函数，将"),s("code",[t._v("i")]),t._v("的值改为1，并将"),s("code",[t._v("param")]),t._v("加上"),s("code",[t._v("i")]),t._v("的值。")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token macro property"}},[s("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("<stdio.h>")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" param "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("func1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" var"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" val"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    var "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" val"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"function func1 has been called!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("func2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("var"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" val"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("var "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" val"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"function func2 has been called!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("func1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("func2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    param "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"function main has been called!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("首先编译该程序并启用 GDB 调试")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ gcc "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-g")]),t._v(" basic.c "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-o")]),t._v(" basic\n$ gdb basic \nGNU gdb "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Ubuntu "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12.1")]),t._v("-0ubuntu1~22.04"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12.1")]),t._v("\nCopyright "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("C"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v(" Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" or later "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://gnu.org/licenses/gpl.html"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\nThis is "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),t._v(" software: you are "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),t._v(" to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\nType "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"show copying"')]),t._v(" and "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"show warranty"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" details.\nThis GDB was configured as "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"x86_64-linux-gnu"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\nType "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"show configuration"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" configuration details.\nFor bug reporting instructions, please see:\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("https://www.gnu.org/software/gdb/bugs/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(".\nFind the GDB manual and other documentation resources online at:\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://www.gnu.org/software/gdb/documentation/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(".\n\nFor help, "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"help"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\nType "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"apropos word"')]),t._v(" to search "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" commands related to "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"word"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nReading symbols from basic"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])]),s("p",[t._v("使用 b 命令将断点打在 "),s("code",[t._v("main")]),t._v(" 函数入口，并使用 r 命令运行程序")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" b main\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" at 0x11d7: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" basic.c, line "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(".\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" r\nStarting program: /home/randy/study/dev-tool/gdb/basic \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Thread debugging using libthread_db enabled"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nUsing "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("host")]),t._v(" libthread_db library "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/lib/x86_64-linux-gnu/libthread_db.so.1"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", main "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at basic.c:15\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v("      int "),s("span",{pre:!0,attrs:{class:"token function-name function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n")])])]),s("p",[t._v("使用 n 命令执行下一行语句，遇到函数直接跳过不进入；使用 s 命令步入函数 "),s("code",[t._v("func1(i,1);")]),t._v("，并使用 l 命令查看当前语句在源码中的上下文。")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v("          int i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v("          func1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" s\nfunc1 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("var"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("val")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at basic.c:6\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("           var "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" val"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" l\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#include<stdio.h>")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("       static int param "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("       void func1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("int var, int val"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("           var "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" val"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v("           printf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"function func1 has been called!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("      void func2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("int *var, int val"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n")])])]),s("p",[t._v("使用 p 命令查看 "),s("code",[t._v("func1(var, val)")]),t._v(" 中 var 在修改前后的值，并查看在 "),s("code",[t._v("func1")]),t._v("  函数执行完成之后，传入的实参 "),s("code",[t._v("i")]),t._v(" 的值未完成修改，仍为 0；")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p var\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v("           printf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"function func1 has been called!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p var\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \nmain "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at basic.c:19\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v("          func2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("i, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p i\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n")])])]),s("p",[t._v("使用 n 命令步过可以完成 "),s("code",[t._v("i")]),t._v(" 值修改的函数 "),s("code",[t._v("func2")]),t._v("，并查看修改之后的值为 1")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \nmain "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at basic.c:19\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v("          func2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("i, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p i\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("          param "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p i\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$4")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p param\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$5")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("          printf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"function main has been called!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p param\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$6")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("23")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("上述完整 gdb 调试过程如下：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ gdb gcc "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-g")]),t._v(" basic.c "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-o")]),t._v(" basic   \n$ gdb gdb basic \nGNU gdb "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Ubuntu "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12.1")]),t._v("-0ubuntu1~22.04"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12.1")]),t._v("\nCopyright "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("C"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v(" Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" or later "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://gnu.org/licenses/gpl.html"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\nThis is "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),t._v(" software: you are "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),t._v(" to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\nType "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"show copying"')]),t._v(" and "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"show warranty"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" details.\nThis GDB was configured as "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"x86_64-linux-gnu"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\nType "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"show configuration"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" configuration details.\nFor bug reporting instructions, please see:\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("https://www.gnu.org/software/gdb/bugs/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(".\nFind the GDB manual and other documentation resources online at:\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--Type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("RET"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" more, q to quit, c to "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("continue")]),t._v(" without paging--\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://www.gnu.org/software/gdb/documentation/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(".\n\nFor help, "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"help"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\nType "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"apropos word"')]),t._v(" to search "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" commands related to "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"word"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nReading symbols from basic"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" b main\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" at 0x11d7: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" basic.c, line "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(".\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" r\nStarting program: /home/randy/study/dev-tool/gdb/basic \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Thread debugging using libthread_db enabled"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nUsing "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("host")]),t._v(" libthread_db library "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/lib/x86_64-linux-gnu/libthread_db.so.1"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", main "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at basic.c:15\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v("      int "),s("span",{pre:!0,attrs:{class:"token function-name function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v("          int i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v("          func1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" s\nfunc1 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("var"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("val")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at basic.c:6\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("           var "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" val"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" l\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#include<stdio.h>")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("       static int param "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("       void func1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("int var, int val"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("           var "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" val"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v("           printf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"function func1 has been called!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("      void func2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("int *var, int val"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p var\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v("           printf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"function func1 has been called!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p var\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \nmain "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at basic.c:19\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v("          func2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("i, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p i\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("          param "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p i\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$4")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p param\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$5")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("          printf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"function main has been called!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p param\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$6")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("23")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n")])])]),s("h1",{attrs:{id:"_02-gdb-调试多进程程序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_02-gdb-调试多进程程序"}},[t._v("#")]),t._v(" 02 GDB 调试多进程程序")]),t._v(" "),s("h2",{attrs:{id:"_2-1-多进程调试中常用的-gdb-命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-多进程调试中常用的-gdb-命令"}},[t._v("#")]),t._v(" 2.1 多进程调试中常用的 GDB 命令")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("命令名称")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("命令缩写")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("命令说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("set follow-fork-mode")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("设置需要跟踪的子进程")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("set detach-on-fork")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("设置在程序运行时是否将调试器与进程分离")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("attach")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("附加到正在运行的进程进行调试")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("detach")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("从正在调试的进程中分离gdb调试器")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("inferior")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("切换到另一个进程上下文进行调试")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("continue")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("c")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("继续执行程序，直到下一个断点或程序结束")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("backtrace")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("bt")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("显示函数调用栈")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("frame")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("f")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("切换到指定堆栈")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("set args")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("设置程序启动命令行参数")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("show args")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("查看设置的命令行参数")])])])]),t._v(" "),s("ol",[s("li",[s("p",[t._v("set follow-fork-mode [parent/child] 指定需要跟踪的子进程")]),t._v(" "),s("blockquote",[s("p",[s("code",[t._v("set follow-fork-mode")]),t._v("命令必须在程序开始执行前设置才能生效。如果在程序启动后再设置该命令，则不会影响当前正在进行的调试会话。该命令 "),s("code",[t._v("set follow-fork-mode MODE")]),t._v(" 可以指定以下三种模式：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("parent")]),t._v("：只跟踪父进程，fork 之后继续调试父进程，子进程不受影响")]),t._v(" "),s("li",[s("code",[t._v("child")]),t._v("：只跟踪子进程，fork之后调试子进程，父进程不受影响")]),t._v(" "),s("li",[s("code",[t._v("ask")]),t._v("：每次 fork 时询问用户选择")])])])]),t._v(" "),s("li",[s("p",[t._v("set detach-on-fork [on/off]是否将调试器与进程分离")]),t._v(" "),s("blockquote",[s("ul",[s("li",[s("p",[s("strong",[t._v("on")]),t._v("， 调试器将与新进程分离，以便在进程创建新进程时能够安全地停止和调试新进程，原进程会继续执行，直到调试器与新进程分离为止")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("off")]),t._v("，调试器将与新进程紧密关联，一直跟随新进程的执行，原进程不会等待新进程完成复制执行环境后才会重新启动")])])])])]),t._v(" "),s("li",[s("p",[t._v("attach/detach 附加/分离指定进程")]),t._v(" "),s("blockquote",[s("ul",[s("li",[s("p",[s("strong",[t._v("attach [PID]")]),t._v("， 让 gdb 附加到已经在运行的进程上进行调试")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("detach [PID]")]),t._v("，从正在调试的进程中分离gdb调试器")])])])])]),t._v(" "),s("li",[s("p",[t._v("inferior 切换到不同的进程上下文进行调试")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("inferior [PID | PNAME]")]),t._v("，其中"),s("code",[t._v("PID")]),t._v("为进程编号，"),s("code",[t._v("PNAME")]),t._v("为进程名称。")])])]),t._v(" "),s("li",[s("p",[t._v("continue 终端程序后继续执行")]),t._v(" "),s("blockquote",[s("p",[t._v("当GDB触发断点或者使用 Ctrl + C 命令中断下来后，想让程序继续运行，只要输入 continue（简写为c）命令即可")])])]),t._v(" "),s("li",[s("p",[t._v("bt/f 显示/切换函数调用栈")]),t._v(" "),s("blockquote",[s("ul",[s("li",[s("strong",[t._v("backtrace")]),t._v("，也可简写为 "),s("strong",[t._v("bt")]),t._v("，用于查看当前调用堆栈")]),t._v(" "),s("li",[s("strong",[t._v("frame 堆栈编号")]),t._v("，也可简写为 "),s("strong",[t._v("f 堆栈编号")]),t._v("，用于切换到其他堆栈处")])])])]),t._v(" "),s("li",[s("p",[t._v("set/show args 设置/查看命令行参数")]),t._v(" "),s("blockquote",[s("ul",[s("li",[s("strong",[t._v("set args args1")]),t._v("，设置单个启动参数 "),s("strong",[t._v("args1")]),t._v("；")]),t._v(" "),s("li",[s("strong",[t._v('set args "-p" "password"')]),t._v("，如果单个参数之间有空格，可以使用引号将参数包裹起来；")]),t._v(" "),s("li",[s("strong",[t._v("set args args1 args2 args3")]),t._v("，设置多个启动参数，参数之间用空格隔开；")]),t._v(" "),s("li",[s("strong",[t._v("set args")]),t._v("，不带参数，则清除之前设置的参数；")])])])])]),t._v(" "),s("h2",{attrs:{id:"_2-2-gdb-多进程调试实例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-gdb-多进程调试实例"}},[t._v("#")]),t._v(" 2.2 GDB 多进程调试实例")]),t._v(" "),s("p",[t._v("下面结合一个例子介绍 gdb 调试多进程程序，例子如下：")]),t._v(" "),s("p",[t._v("程序首先创建了一个管道，然后通过"),s("code",[t._v("fork()")]),t._v("函数创建了两个子进程。")]),t._v(" "),s("p",[t._v("在第一个子进程中，它向管道的写端写入了一条消息，然后退出；在第二个子进程中，它从管道的读端读取了这条消息，并将其打印出来，然后退出。")]),t._v(" "),s("p",[t._v("父进程在创建完子进程后，关闭了管道的读端和写端，并分别等待两个子进程结束。")]),t._v(" "),s("p",[t._v("当两个子进程都结束时，父进程才会继续执行，并打印一条消息表示所有子进程都已完成。")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token macro property"}},[s("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("<stdio.h>")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token macro property"}},[s("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("<stdlib.h>")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token macro property"}},[s("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("<unistd.h>")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token macro property"}},[s("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("<string.h>")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token macro property"}},[s("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("<sys/wait.h>")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 管道描述符数组")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("pid_t")]),t._v(" pid1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pid2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 子进程ID变量")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建管道")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("perror")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pipe"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EXIT_FAILURE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    pid1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fork")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建第一个子进程")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("perror")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fork"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EXIT_FAILURE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在第一个子进程中")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 关闭读端")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello, I\'m child process 1!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("strlen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 向写端写入消息")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 关闭写端")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EXIT_SUCCESS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n\n    pid2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fork")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建第二个子进程")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("perror")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fork"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EXIT_FAILURE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在第二个子进程中")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 关闭写端")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" buf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("read")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" buf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sizeof")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("buf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 从读端读取消息")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"This is child process 2. Received message from child process 1: %s\\n"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" buf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 关闭读端")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EXIT_SUCCESS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 父进程中")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 关闭读端")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 关闭写端")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("waitpid")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NULL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 等待第一个子进程结束")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("waitpid")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NULL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 等待第二个子进程结束")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"All child processes have completed.\\n"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-2-1-调试父进程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-调试父进程"}},[t._v("#")]),t._v(" 2.2.1 调试父进程")]),t._v(" "),s("p",[t._v("首先编译该程序并启用 GDB 调试")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ gdb gcc "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-g")]),t._v(" multi_process.c "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-o")]),t._v(" multi_process   \n$ gdb gdb multi_process \nGNU gdb "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Ubuntu "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12.1")]),t._v("-0ubuntu1~22.04"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12.1")]),t._v("\nCopyright "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("C"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v(" Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" or later "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://gnu.org/licenses/gpl.html"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\nThis is "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),t._v(" software: you are "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),t._v(" to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\nType "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"show copying"')]),t._v(" and "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"show warranty"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" details.\nThis GDB was configured as "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"x86_64-linux-gnu"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\nType "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"show configuration"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" configuration details.\nFor bug reporting instructions, please see:\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("https://www.gnu.org/software/gdb/bugs/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(".\nFind the GDB manual and other documentation resources online at:\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://www.gnu.org/software/gdb/documentation/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(".\n\nFor help, "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"help"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\nType "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"apropos word"')]),t._v(" to search "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" commands related to "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"word"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nReading symbols from multi_process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])]),s("p",[s("strong",[t._v("set follow-fork-mode parent 设置仅跟踪父进程")]),t._v("（也可以直接跳过这个步骤，默认 parent）；使用 b 命令将断点打在 "),s("code",[t._v("main")]),t._v(" 函数入口；并使用 r 命令运行程序。")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" follow-fork-mode parent\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" b main\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" at 0x4007f8: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" multi_process.c, line "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(".\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" r\nStarting program: /home/randy/study/dev-tool/gdb/multi_process \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Thread debugging using libthread_db enabled"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nUsing "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("host")]),t._v(" libthread_db library "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/lib/x86_64-linux-gnu/libthread_db.so.1"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", main "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at multi_process.c:7\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v("       int "),s("span",{pre:!0,attrs:{class:"token function-name function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n")])])]),s("p",[t._v("使用 n 命令单步执行，查看程序执行情况，可以看到"),s("strong",[t._v("第一个子进程")]),t._v("在被 fork 成功之后就从 gdb 调试中分离并继续执行了 "),s("code",[t._v("[Detaching after fork from child process 20228]")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v("          pid1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fork"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  // 创建第一个子进程\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p pid1\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Detaching after fork from child process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20228")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" -1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  // 在第一个子进程中\n")])])]),s("p",[t._v("同样的继续使用 n 命令单步执行，可以看到第二个子进程在被 fork 成功之后也从 gdb 调试中分离 "),s("code",[t._v("[Detaching after fork from child process 20415]")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v("          pid2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fork"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  // 创建第二个子进程\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p pid2\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Detaching after fork from child process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20415")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 第二个子进程执行完成读取第一个子进程发送的消息并打印如下输出")]),t._v("\nThis is child process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(". Received message from child process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": Hello, I'm child process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" -1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("36")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  // 在第二个子进程中\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("46")]),t._v("          close"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  // 关闭读端\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("47")]),t._v("          close"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  // 关闭写端\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("48")]),t._v("          waitpid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid1, NULL, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  // 等待第一个子进程结束\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("49")]),t._v("          waitpid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid2, NULL, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  // 等待第二个子进程结束\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v("          printf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"All child processes have completed.'),s("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v('"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \nAll child processes have completed.\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("52")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-2-2-调试第一个子进程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-调试第一个子进程"}},[t._v("#")]),t._v(" 2.2.2 调试第一个子进程")]),t._v(" "),s("p",[t._v("首先编译该程序并启用 GDB 调试")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ gdb gcc "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-g")]),t._v(" multi_process.c "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-o")]),t._v(" multi_process   \n$ gdb gdb multi_process \nGNU gdb "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Ubuntu "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12.1")]),t._v("-0ubuntu1~22.04"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12.1")]),t._v("\nCopyright "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("C"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v(" Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" or later "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://gnu.org/licenses/gpl.html"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\nThis is "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),t._v(" software: you are "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),t._v(" to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\nType "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"show copying"')]),t._v(" and "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"show warranty"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" details.\nThis GDB was configured as "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"x86_64-linux-gnu"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\nType "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"show configuration"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" configuration details.\nFor bug reporting instructions, please see:\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("https://www.gnu.org/software/gdb/bugs/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(".\nFind the GDB manual and other documentation resources online at:\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://www.gnu.org/software/gdb/documentation/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(".\n\nFor help, "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"help"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\nType "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"apropos word"')]),t._v(" to search "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" commands related to "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"word"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nReading symbols from multi_process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])]),s("p",[s("strong",[t._v("set follow-fork-mode child 设置跟踪子进程")]),t._v("，使用 b 命令将断点打在 "),s("code",[t._v("main")]),t._v(" 函数入口，并使用 r 命令运行程序")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" follow-fork-mode child\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" b main\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" at 0x12b8: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" multi_process.c, line "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v(".\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" r\nStarting program: /home/randy/study/dev-tool/gdb/multi_process \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Thread debugging using libthread_db enabled"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nUsing "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("host")]),t._v(" libthread_db library "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/lib/x86_64-linux-gnu/libthread_db.so.1"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", main "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at multi_process.c:7\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v("       int "),s("span",{pre:!0,attrs:{class:"token function-name function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n")])])]),s("p",[t._v("n 单步执行程序，直到第一个子进程 pid1=0")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" -1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  // 创建管道\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v("          pid1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fork"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  // 创建第一个子进程\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p pid1\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Attaching after Thread 0x7ffff7d8c740 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LWP "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5001")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" fork to child process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5166")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 表示gdb正在附加到一个已经fork出子进程的父进程中")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("New inferior "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5166")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 表示gdb创建了一个新的被调试进程，并将其编号设置为2，该进程的PID为5166")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Detaching after fork from parent process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5001")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 表示gdb从父进程中分离出子进程，将其作为独立的被调试进程进行调试")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Inferior "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5001")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" detached"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 表示gdb已经从原始的父进程中分离出来，成为一个独立的进程（或线程）控制器。由于该进程的编号为1，因此显示为Inferior 1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Thread debugging using libthread_db enabled"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 表示gdb使用libthread_db库来进行线程调试")]),t._v("\nUsing "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("host")]),t._v(" libthread_db library "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/lib/x86_64-linux-gnu/libthread_db.so.1"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Switching to Thread 0x7ffff7d8c740 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LWP "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5166")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 表示gdb正在切换到子进程的线程上进行调试")]),t._v("\nmain "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at multi_process.c:17\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" -1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n")])])]),s("p",[t._v("在子进程中 使用 n 命令单步执行并观察变量值，由于 set follow-fork-mode child 只跟踪子进程，在上一步中 "),s("code",[t._v("[Inferior 1 (process 5001) detached]")]),t._v(" 表示 gdb 已经"),s("strong",[t._v("将父进程分离并继续执行")]),t._v("，所以在下面的内容中第一个子进程写完消息之后，第二个子进程就收到了消息并在打印后退出了。")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  // 在第一个子进程中\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("23")]),t._v("              close"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  // 关闭读端\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v("              char msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello, I\'m child process 1!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p msg\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(' "`'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("317")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("377")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("367")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("377")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("177")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("000"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("000"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("330J"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("374")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("367")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("377")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("177")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("000"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("000"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("000"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("000"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("000"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("000"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("000"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("000"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("000"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("000"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("060"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("334")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("377")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("377")]),t._v('"\n'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v("              write"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", msg, strlen"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("))")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  // 向写端写入消息\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \nThis is child process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(". Received message from child process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": Hello, I'm child process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v("              close"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  // 关闭写端\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("27")]),t._v("              exit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EXIT_SUCCESS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Inferior "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6971")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" exited normally"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nAll child processes have completed.\n")])])]),s("h3",{attrs:{id:"_2-2-3-调试第二个子进程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-3-调试第二个子进程"}},[t._v("#")]),t._v(" 2.2.3 调试第二个子进程")]),t._v(" "),s("p",[t._v("首先编译该程序并启用 GDB 调试")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ gdb gcc "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-g")]),t._v(" multi_process.c "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-o")]),t._v(" multi_process   \n$ gdb gdb multi_process \nGNU gdb "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Ubuntu "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12.1")]),t._v("-0ubuntu1~22.04"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12.1")]),t._v("\nCopyright "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("C"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v(" Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" or later "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://gnu.org/licenses/gpl.html"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\nThis is "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),t._v(" software: you are "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),t._v(" to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\nType "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"show copying"')]),t._v(" and "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"show warranty"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" details.\nThis GDB was configured as "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"x86_64-linux-gnu"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\nType "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"show configuration"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" configuration details.\nFor bug reporting instructions, please see:\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("https://www.gnu.org/software/gdb/bugs/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(".\nFind the GDB manual and other documentation resources online at:\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://www.gnu.org/software/gdb/documentation/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(".\n\nFor help, "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"help"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\nType "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"apropos word"')]),t._v(" to search "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" commands related to "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"word"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nReading symbols from multi_process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])]),s("p",[t._v("先设置跟踪父进程 "),s("strong",[t._v("set follow-fork-mode parent")]),t._v(" 来跳过第一个子进程的 fork 操作；使用 b 命令将断点"),s("strong",[t._v("打在创建第二个子进程的 fork 函数之前")]),t._v("；并使用 r 命令运行程序。")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" follow-fork-mode parent\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" b multi_process.c:22\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" at 0x40083f: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" multi_process.c, line "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(".\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" r\nStarting program: /home/randy/study/dev-tool/gdb/multi_process \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Detaching after fork from child process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25249")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 分离第一个子进程")]),t._v("\n\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", main "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at multi_process.c:22\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  // 在第一个子进程中\n")])])]),s("p",[t._v("在继续执行程序前 "),s("strong",[t._v("set follow-fork-mode child")]),t._v(" 设置 gdb 调试跟踪子进程，然后再使用 n 命令单步执行 fork 创建第二个子进程，可以看到第二个子进程在被 fork 成功之后，gdb 调试就分离的父进程，并切换到第二个子进程中。")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" follow-fork-mode child\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v("          pid2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fork"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  // 创建第二个子进程\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Attaching after process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25358")]),t._v(" fork to child process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25358")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("New inferior "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25358")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Detaching after fork from parent process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25245")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Inferior "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25245")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" detached"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 已经分离父进程")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Switching to process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25358")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 切换到第二个子进程")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" -1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n")])])]),s("p",[t._v("进入第二个子进程后，就可以使用 n 命令单步执行程序，使用 p 命令查看变量值。")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("36")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  // 在第二个子进程中\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p pid2\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("37")]),t._v("              close"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  // 关闭写端\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("39")]),t._v("              read"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", buf, sizeof"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("buf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("))")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  // 从读端读取消息\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("40")]),t._v("              printf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"This is child process 2. Received message from child process 1: %s'),s("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v('"')]),t._v(", buf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p buf\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello, I\'m child process 1!"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\000'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("repeats "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("477")]),t._v(" times"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\nThis is child process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(". Received message from child process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": Hello, I'm child process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("41")]),t._v("              close"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pipefd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  // 关闭读端\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("42")]),t._v("              exit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EXIT_SUCCESS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Inferior "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25358")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" exited normally"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nAll child processes have completed.\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);