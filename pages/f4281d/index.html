<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>GDB基础调试 | 王清欢Randy</title>
    <meta name="generator" content="VuePress 1.9.2">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="解决问题，担当责任，优雅生活。">
    <meta name="keywords" content="vuepress,it,blog">
    <meta name="theme-color" content="#cf2825">
    
    <link rel="preload" href="/assets/css/0.styles.ded236f3.css" as="style"><link rel="preload" href="/assets/js/app.3c964c09.js" as="script"><link rel="preload" href="/assets/js/2.7cb4c100.js" as="script"><link rel="preload" href="/assets/js/139.4153d23d.js" as="script"><link rel="prefetch" href="/assets/js/10.63f63ae7.js"><link rel="prefetch" href="/assets/js/100.95a6c99c.js"><link rel="prefetch" href="/assets/js/101.b4a49f0b.js"><link rel="prefetch" href="/assets/js/102.2de85a2d.js"><link rel="prefetch" href="/assets/js/103.45e2e113.js"><link rel="prefetch" href="/assets/js/104.56158bd6.js"><link rel="prefetch" href="/assets/js/105.1f16775f.js"><link rel="prefetch" href="/assets/js/106.84151016.js"><link rel="prefetch" href="/assets/js/107.7b9fd16b.js"><link rel="prefetch" href="/assets/js/108.9a669853.js"><link rel="prefetch" href="/assets/js/109.607b8ba0.js"><link rel="prefetch" href="/assets/js/11.9a5b96b4.js"><link rel="prefetch" href="/assets/js/110.035ebd82.js"><link rel="prefetch" href="/assets/js/111.2189344f.js"><link rel="prefetch" href="/assets/js/112.acc94015.js"><link rel="prefetch" href="/assets/js/113.732292c6.js"><link rel="prefetch" href="/assets/js/114.69d6fa65.js"><link rel="prefetch" href="/assets/js/115.b01a3599.js"><link rel="prefetch" href="/assets/js/116.6724705b.js"><link rel="prefetch" href="/assets/js/117.ce49efe5.js"><link rel="prefetch" href="/assets/js/118.28357f19.js"><link rel="prefetch" href="/assets/js/119.183d08ed.js"><link rel="prefetch" href="/assets/js/12.44fb0008.js"><link rel="prefetch" href="/assets/js/120.474cdfad.js"><link rel="prefetch" href="/assets/js/121.e3ecdcc4.js"><link rel="prefetch" href="/assets/js/122.0a0bc0aa.js"><link rel="prefetch" href="/assets/js/123.0c6ab3ab.js"><link rel="prefetch" href="/assets/js/124.0d0ffb49.js"><link rel="prefetch" href="/assets/js/125.0e81a183.js"><link rel="prefetch" href="/assets/js/126.aad938f8.js"><link rel="prefetch" href="/assets/js/127.a0f92902.js"><link rel="prefetch" href="/assets/js/128.1d6192b0.js"><link rel="prefetch" href="/assets/js/129.b953e757.js"><link rel="prefetch" href="/assets/js/13.a330722e.js"><link rel="prefetch" href="/assets/js/130.7bb5e38e.js"><link rel="prefetch" href="/assets/js/131.7462b2ba.js"><link rel="prefetch" href="/assets/js/132.c0928987.js"><link rel="prefetch" href="/assets/js/133.198cb7db.js"><link rel="prefetch" href="/assets/js/134.297283a1.js"><link rel="prefetch" href="/assets/js/135.7f82baca.js"><link rel="prefetch" href="/assets/js/136.0c6b96f4.js"><link rel="prefetch" href="/assets/js/137.dae22f59.js"><link rel="prefetch" href="/assets/js/138.30641cf0.js"><link rel="prefetch" href="/assets/js/14.6847a39f.js"><link rel="prefetch" href="/assets/js/140.c25d78fc.js"><link rel="prefetch" href="/assets/js/141.496ceb78.js"><link rel="prefetch" href="/assets/js/142.0de8f200.js"><link rel="prefetch" href="/assets/js/143.28d82825.js"><link rel="prefetch" href="/assets/js/144.acce788f.js"><link rel="prefetch" href="/assets/js/145.9cfb27d2.js"><link rel="prefetch" href="/assets/js/146.6230832c.js"><link rel="prefetch" href="/assets/js/147.121e1344.js"><link rel="prefetch" href="/assets/js/148.f0e26f06.js"><link rel="prefetch" href="/assets/js/149.dea71d53.js"><link rel="prefetch" href="/assets/js/15.0e030877.js"><link rel="prefetch" href="/assets/js/150.9ba2012f.js"><link rel="prefetch" href="/assets/js/151.59a8ddd9.js"><link rel="prefetch" href="/assets/js/152.1d937849.js"><link rel="prefetch" href="/assets/js/153.d9366ef7.js"><link rel="prefetch" href="/assets/js/154.9d104827.js"><link rel="prefetch" href="/assets/js/155.96d646cc.js"><link rel="prefetch" href="/assets/js/156.f87e7868.js"><link rel="prefetch" href="/assets/js/157.9fd3efa6.js"><link rel="prefetch" href="/assets/js/158.75948c6a.js"><link rel="prefetch" href="/assets/js/159.9b842781.js"><link rel="prefetch" href="/assets/js/16.74612e69.js"><link rel="prefetch" href="/assets/js/160.56221aa8.js"><link rel="prefetch" href="/assets/js/161.17b059f2.js"><link rel="prefetch" href="/assets/js/162.668f0874.js"><link rel="prefetch" href="/assets/js/163.b6b0e348.js"><link rel="prefetch" href="/assets/js/164.341c344d.js"><link rel="prefetch" href="/assets/js/165.c8c5e318.js"><link rel="prefetch" href="/assets/js/166.15c69481.js"><link rel="prefetch" href="/assets/js/167.0d5a35a6.js"><link rel="prefetch" href="/assets/js/168.169a4503.js"><link rel="prefetch" href="/assets/js/169.0918ad60.js"><link rel="prefetch" href="/assets/js/17.aff28c92.js"><link rel="prefetch" href="/assets/js/170.1f41cdee.js"><link rel="prefetch" href="/assets/js/171.32de0dd3.js"><link rel="prefetch" href="/assets/js/172.8d0977fa.js"><link rel="prefetch" href="/assets/js/173.7f833ed2.js"><link rel="prefetch" href="/assets/js/174.e3cf5acf.js"><link rel="prefetch" href="/assets/js/175.c5e1249f.js"><link rel="prefetch" href="/assets/js/176.36d2aed6.js"><link rel="prefetch" href="/assets/js/177.2b946f65.js"><link rel="prefetch" href="/assets/js/178.6471a14e.js"><link rel="prefetch" href="/assets/js/18.6c553fe2.js"><link rel="prefetch" href="/assets/js/19.25a79e40.js"><link rel="prefetch" href="/assets/js/20.2912c5fd.js"><link rel="prefetch" href="/assets/js/21.cc8f7cb4.js"><link rel="prefetch" href="/assets/js/22.73f5d0fb.js"><link rel="prefetch" href="/assets/js/23.082f826b.js"><link rel="prefetch" href="/assets/js/24.62a7a3fb.js"><link rel="prefetch" href="/assets/js/25.3f1ff6cb.js"><link rel="prefetch" href="/assets/js/26.02eb8e1c.js"><link rel="prefetch" href="/assets/js/27.c669fe7b.js"><link rel="prefetch" href="/assets/js/28.5c92c35c.js"><link rel="prefetch" href="/assets/js/29.5b037672.js"><link rel="prefetch" href="/assets/js/3.5e9c9aeb.js"><link rel="prefetch" href="/assets/js/30.503d0120.js"><link rel="prefetch" href="/assets/js/31.24297fec.js"><link rel="prefetch" href="/assets/js/32.96252ef0.js"><link rel="prefetch" href="/assets/js/33.c89e1ff8.js"><link rel="prefetch" href="/assets/js/34.d3ccb114.js"><link rel="prefetch" href="/assets/js/35.16c1381a.js"><link rel="prefetch" href="/assets/js/36.bf337c21.js"><link rel="prefetch" href="/assets/js/37.946363a7.js"><link rel="prefetch" href="/assets/js/38.97180054.js"><link rel="prefetch" href="/assets/js/39.db68880e.js"><link rel="prefetch" href="/assets/js/4.4290cd63.js"><link rel="prefetch" href="/assets/js/40.fdfa3edb.js"><link rel="prefetch" href="/assets/js/41.1364b864.js"><link rel="prefetch" href="/assets/js/42.b5fe6688.js"><link rel="prefetch" href="/assets/js/43.a657a0ea.js"><link rel="prefetch" href="/assets/js/44.c60c202e.js"><link rel="prefetch" href="/assets/js/45.f0ca7707.js"><link rel="prefetch" href="/assets/js/46.a2cfa915.js"><link rel="prefetch" href="/assets/js/47.00eaf68b.js"><link rel="prefetch" href="/assets/js/48.0697506a.js"><link rel="prefetch" href="/assets/js/49.d975a8c1.js"><link rel="prefetch" href="/assets/js/5.c8d737d0.js"><link rel="prefetch" href="/assets/js/50.d71495f8.js"><link rel="prefetch" href="/assets/js/51.45b983df.js"><link rel="prefetch" href="/assets/js/52.86cfff51.js"><link rel="prefetch" href="/assets/js/53.7aab1ca2.js"><link rel="prefetch" href="/assets/js/54.4d1b9288.js"><link rel="prefetch" href="/assets/js/55.5b50da92.js"><link rel="prefetch" href="/assets/js/56.2c9ea1c5.js"><link rel="prefetch" href="/assets/js/57.ed975abb.js"><link rel="prefetch" href="/assets/js/58.c103cc9b.js"><link rel="prefetch" href="/assets/js/59.aa73a8af.js"><link rel="prefetch" href="/assets/js/6.a41c5e20.js"><link rel="prefetch" href="/assets/js/60.12f2b692.js"><link rel="prefetch" href="/assets/js/61.83fae5c1.js"><link rel="prefetch" href="/assets/js/62.e31f6715.js"><link rel="prefetch" href="/assets/js/63.295992f4.js"><link rel="prefetch" href="/assets/js/64.2fc8a996.js"><link rel="prefetch" href="/assets/js/65.3d399173.js"><link rel="prefetch" href="/assets/js/66.aa557906.js"><link rel="prefetch" href="/assets/js/67.254bd65a.js"><link rel="prefetch" href="/assets/js/68.ad2097e4.js"><link rel="prefetch" href="/assets/js/69.b9231851.js"><link rel="prefetch" href="/assets/js/7.77d76dfa.js"><link rel="prefetch" href="/assets/js/70.49947637.js"><link rel="prefetch" href="/assets/js/71.d2610084.js"><link rel="prefetch" href="/assets/js/72.bff01f1e.js"><link rel="prefetch" href="/assets/js/73.3d9b6c19.js"><link rel="prefetch" href="/assets/js/74.a4201e96.js"><link rel="prefetch" href="/assets/js/75.8489c790.js"><link rel="prefetch" href="/assets/js/76.2f9bc769.js"><link rel="prefetch" href="/assets/js/77.ff492b54.js"><link rel="prefetch" href="/assets/js/78.31c6d8b2.js"><link rel="prefetch" href="/assets/js/79.21d03938.js"><link rel="prefetch" href="/assets/js/8.45e21c4e.js"><link rel="prefetch" href="/assets/js/80.0e9d328b.js"><link rel="prefetch" href="/assets/js/81.871bf4a7.js"><link rel="prefetch" href="/assets/js/82.e75460b6.js"><link rel="prefetch" href="/assets/js/83.e13d0013.js"><link rel="prefetch" href="/assets/js/84.8c34a475.js"><link rel="prefetch" href="/assets/js/85.e108fbd1.js"><link rel="prefetch" href="/assets/js/86.7d4ff604.js"><link rel="prefetch" href="/assets/js/87.53bc3752.js"><link rel="prefetch" href="/assets/js/88.a45401e3.js"><link rel="prefetch" href="/assets/js/89.b419f73b.js"><link rel="prefetch" href="/assets/js/9.c216597d.js"><link rel="prefetch" href="/assets/js/90.c7fe862e.js"><link rel="prefetch" href="/assets/js/91.ef3cfddd.js"><link rel="prefetch" href="/assets/js/92.721483d9.js"><link rel="prefetch" href="/assets/js/93.c070a2da.js"><link rel="prefetch" href="/assets/js/94.0295dc34.js"><link rel="prefetch" href="/assets/js/95.f327f220.js"><link rel="prefetch" href="/assets/js/96.922233b5.js"><link rel="prefetch" href="/assets/js/97.1c062e72.js"><link rel="prefetch" href="/assets/js/98.bc678e0d.js"><link rel="prefetch" href="/assets/js/99.40c68a6a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ded236f3.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="王清欢Randy" class="logo"> <span class="site-name can-hide">王清欢Randy</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程基础" class="dropdown-title"><a href="/pages/fa0f35/" class="link-title">编程基础</a> <span class="title" style="display:none;">编程基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>编程语言</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/bb810c/" class="nav-link">C/C++ 学习笔记</a></li><li class="dropdown-subitem"><a href="/pages/4b9df2/" class="nav-link">Golang 学习笔记</a></li></ul></li><li class="dropdown-item"><h4>算法分析</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/0f3851/" class="nav-link">LeetCode 刷题笔记</a></li></ul></li><li class="dropdown-item"><h4>操作系统</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/bcf4de/" class="nav-link">Linux 基础</a></li><li class="dropdown-subitem"><a href="/pages/875f14/" class="nav-link">Vim 实用技巧</a></li><li class="dropdown-subitem"><a href="/pages/028d7e/" class="nav-link">Shell 脚本编程</a></li><li class="dropdown-subitem"><a href="/pages/f4281d/" aria-current="page" class="nav-link router-link-exact-active router-link-active">GDB 学习笔记</a></li></ul></li><li class="dropdown-item"><h4>开发工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8292d8/" class="nav-link">Git 学习笔记</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="理论知识" class="dropdown-title"><a href="/pages/240fd4/" class="link-title">理论知识</a> <span class="title" style="display:none;">理论知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>分布式理论</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/f4281d/404" class="nav-link">共识算法</a></li><li class="dropdown-subitem"><a href="/pages/f4281d/404" class="nav-link">分布式事务</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开源实践" class="dropdown-title"><a href="/pages/93824d/" class="link-title">开源实践</a> <span class="title" style="display:none;">开源实践</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>数据库内核</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/f4281d/404" class="nav-link">PostgreSQL</a></li><li class="dropdown-subitem"><a href="/pages/f4281d/404" class="nav-link">Postgres-XL</a></li></ul></li><li class="dropdown-item"><!----> <a href="/pages/f4281d/404" class="nav-link">hidb</a></li><li class="dropdown-item"><!----> <a href="/pages/f4281d/404" class="nav-link">pgproxy</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="胡思乱想" class="dropdown-title"><a href="/pages/0232db/" class="link-title">胡思乱想</a> <span class="title" style="display:none;">胡思乱想</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习方法</a></li><li class="dropdown-item"><!----> <a href="/pages/35750f/" class="nav-link">资源分享</a></li></ul></div></div> <a href="https://github.com/wang-haihua/TechStack" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程基础" class="dropdown-title"><a href="/pages/fa0f35/" class="link-title">编程基础</a> <span class="title" style="display:none;">编程基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>编程语言</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/bb810c/" class="nav-link">C/C++ 学习笔记</a></li><li class="dropdown-subitem"><a href="/pages/4b9df2/" class="nav-link">Golang 学习笔记</a></li></ul></li><li class="dropdown-item"><h4>算法分析</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/0f3851/" class="nav-link">LeetCode 刷题笔记</a></li></ul></li><li class="dropdown-item"><h4>操作系统</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/bcf4de/" class="nav-link">Linux 基础</a></li><li class="dropdown-subitem"><a href="/pages/875f14/" class="nav-link">Vim 实用技巧</a></li><li class="dropdown-subitem"><a href="/pages/028d7e/" class="nav-link">Shell 脚本编程</a></li><li class="dropdown-subitem"><a href="/pages/f4281d/" aria-current="page" class="nav-link router-link-exact-active router-link-active">GDB 学习笔记</a></li></ul></li><li class="dropdown-item"><h4>开发工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8292d8/" class="nav-link">Git 学习笔记</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="理论知识" class="dropdown-title"><a href="/pages/240fd4/" class="link-title">理论知识</a> <span class="title" style="display:none;">理论知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>分布式理论</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/f4281d/404" class="nav-link">共识算法</a></li><li class="dropdown-subitem"><a href="/pages/f4281d/404" class="nav-link">分布式事务</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开源实践" class="dropdown-title"><a href="/pages/93824d/" class="link-title">开源实践</a> <span class="title" style="display:none;">开源实践</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>数据库内核</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/f4281d/404" class="nav-link">PostgreSQL</a></li><li class="dropdown-subitem"><a href="/pages/f4281d/404" class="nav-link">Postgres-XL</a></li></ul></li><li class="dropdown-item"><!----> <a href="/pages/f4281d/404" class="nav-link">hidb</a></li><li class="dropdown-item"><!----> <a href="/pages/f4281d/404" class="nav-link">pgproxy</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="胡思乱想" class="dropdown-title"><a href="/pages/0232db/" class="link-title">胡思乱想</a> <span class="title" style="display:none;">胡思乱想</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习方法</a></li><li class="dropdown-item"><!----> <a href="/pages/35750f/" class="nav-link">资源分享</a></li></ul></div></div> <a href="https://github.com/wang-haihua/TechStack" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Linux 基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/bcf4de/" class="sidebar-link">基本Linux命令</a></li><li><a href="/pages/f56384/" class="sidebar-link">文件与目录操作</a></li><li><a href="/pages/0b3143/" class="sidebar-link">进程与线程</a></li><li><a href="/pages/ff5e65/" class="sidebar-link">线程同步与进程通信</a></li><li><a href="/pages/5d33e8/" class="sidebar-link">Linux 文件权限</a></li><li><a href="/pages/154d65/" class="sidebar-link">Linux 命令行快捷键</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vim 实用技巧</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/875f14/" class="sidebar-link">Vim常用技巧</a></li><li><a href="/pages/dfff1a/" class="sidebar-link">Vim解决问题的方式</a></li><li><a href="/pages/7fbd14/" class="sidebar-link">Vim普通模式</a></li><li><a href="/pages/aab584/" class="sidebar-link">Vim插入模式</a></li><li><a href="/pages/2a0740/" class="sidebar-link">Vim可视模式</a></li><li><a href="/pages/d598a0/" class="sidebar-link">Vim命令行模式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Shell 脚本编程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/028d7e/" class="sidebar-link">目录</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>GDB学习笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/f4281d/" aria-current="page" class="active sidebar-link">GDB基础调试</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/f4281d/#_1-1-基础使用" class="sidebar-link">1.1 基础使用</a></li><li class="sidebar-sub-header level2"><a href="/pages/f4281d/#_1-2-常用命令" class="sidebar-link">1.2 常用命令</a></li><li class="sidebar-sub-header level2"><a href="/pages/f4281d/#_1-3-gdb-基础调试实例" class="sidebar-link">1.3 GDB 基础调试实例</a></li><li class="sidebar-sub-header level2"><a href="/pages/f4281d/#_2-1-多进程调试中常用的-gdb-命令" class="sidebar-link">2.1 多进程调试中常用的 GDB 命令</a></li><li class="sidebar-sub-header level2"><a href="/pages/f4281d/#_2-2-gdb-多进程调试实例" class="sidebar-link">2.2 GDB 多进程调试实例</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/f4281d/#_2-2-1-调试父进程" class="sidebar-link">2.2.1 调试父进程</a></li><li class="sidebar-sub-header level3"><a href="/pages/f4281d/#_2-2-2-调试第一个子进程" class="sidebar-link">2.2.2 调试第一个子进程</a></li><li class="sidebar-sub-header level3"><a href="/pages/f4281d/#_2-2-3-调试第二个子进程" class="sidebar-link">2.2.3 调试第二个子进程</a></li></ul></li></ul></li><li><a href="/pages/2f33c0/" class="sidebar-link">GDB调试Coredump</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>Linux操作系统编程</span></li><li data-v-06225672><span data-v-06225672>GDB学习笔记</span></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/wang-haihua" target="_blank" title="作者" class="beLink" data-v-06225672>王清欢</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-05-27</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">GDB基础调试<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="_01-gdb-基础调试"><a href="#_01-gdb-基础调试" class="header-anchor">#</a> 01 GDB 基础调试</h1> <blockquote><p>reference:</p> <p><a href="https://zhuanlan.zhihu.com/p/357067993" target="_blank" rel="noopener noreferrer">学习使用 GDB 调试代码 | Linux 中国 - 知乎 (zhihu.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://zhuanlan.zhihu.com/p/297925056" target="_blank" rel="noopener noreferrer">GDB使用详解 - 知乎 (zhihu.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://www.sourceware.org/gdb/documentation/" target="_blank" rel="noopener noreferrer">GDB Documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://www.jianshu.com/p/8fc05dbf777e" target="_blank" rel="noopener noreferrer">使用 GDB 调试多进程程序 - 简书<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>​ GDB 全称“GNU symbolic debugger”是 Linux 下常用的程序调试器，当下的 GDB 支持调试多种编程语言编写的程序，包括 C、C++、Go、Objective-C、OpenCL、Ada 等。</p> <h2 id="_1-1-基础使用"><a href="#_1-1-基础使用" class="header-anchor">#</a> 1.1 基础使用</h2> <ol><li><strong>安装工具</strong></li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 安装 gcc</span>
<span class="token function">sudo</span> yum <span class="token function">install</span> gcc
<span class="token comment"># 安装 g++</span>
<span class="token function">sudo</span> yum <span class="token function">install</span> gcc-c++ 
<span class="token comment"># 安装 gdb</span>
<span class="token function">sudo</span> yum <span class="token function">install</span> gdb
</code></pre></div><ol start="2"><li><strong>编译程序</strong></li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>gcc <span class="token parameter variable">-g</span> basic.c <span class="token parameter variable">-o</span> basic
</code></pre></div><p>使用GDB调试程序，编译程序的过程中需要注意以下两点：</p> <ol><li>要使用GDB调试某个程序，该程序编译时需要加上编译选项 <strong><code>-g</code></strong>，否则编译生成的程序是不包含调试信息的；</li> <li>GCC编译器支持 <strong><code>-O</code></strong> 和 <strong><code>-g</code></strong> 一起参与编译，关闭编译器的程序优化选项。GCC编译过程对进行优化的程度分为5个等级：-O/O0, -O1, -O2, -O3, -Os，调试时一般选择默认选项 -O 不做任何优化。</li></ol> <blockquote><p><strong>调试信息</strong>：reference: <a href="https://zhuanlan.zhihu.com/p/141233227" target="_blank" rel="noopener noreferrer">GDB调试信息与调试原理 - 知乎 (zhihu.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>如果编译命令中不加 -g 选项，在编译后的程序中不会保留调试符号信息。</p> <p>加不加该选项在启用 GDB 调试时存在明显区别</p> <div class="language-bash extra-class"><pre class="language-bash"><code>gdb basic
</code></pre></div><p>（1）不加 -g 选项，尾行打印内容为</p> <div class="language- extra-class"><pre class="language-text"><code>Reading symbols from basic...(No debugging symbols found in basic)
</code></pre></div><p>（2）加 -g 选项，尾行打印内容为</p> <div class="language- extra-class"><pre class="language-text"><code>Reading symbols from basic...
</code></pre></div><p>可以看到，不加 -g 选项会直接提示程序不包含调试信息 <code>No debugging symbols found in basic</code></p></blockquote> <ol start="3"><li><strong>启动 GDB 调试</strong></li></ol> <p>GDB调试主要有三种方式：</p> <ul><li><p>直接调试目标程序：gdb ./basic</p></li> <li><p>附加进程id：gdb attach pid</p></li> <li><p>调试core文件：gdb filename corename</p></li></ul> <ol start="4"><li><strong>退出 GDB 调试</strong></li></ol> <ul><li><p>可以用命令：q（quit的缩写）或者 Ctr + d 退出 GDB。</p></li> <li><p>如果GDB attach某个进程，退出GDB之前要用命令 detach 解除附加进程。</p></li></ul> <h2 id="_1-2-常用命令"><a href="#_1-2-常用命令" class="header-anchor">#</a> 1.2 常用命令</h2> <blockquote><p>本节内容转自：<a href="https://zhuanlan.zhihu.com/p/297925056" target="_blank" rel="noopener noreferrer">GDB使用详解 - 知乎 (zhihu.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <table><thead><tr><th style="text-align:center;">命令名称</th> <th style="text-align:center;">命令缩写</th> <th style="text-align:center;">命令说明</th></tr></thead> <tbody><tr><td style="text-align:center;">run</td> <td style="text-align:center;">r</td> <td style="text-align:center;">运行一个待调试的程序</td></tr> <tr><td style="text-align:center;">continue</td> <td style="text-align:center;">c</td> <td style="text-align:center;">让暂停的程序继续运行</td></tr> <tr><td style="text-align:center;">next</td> <td style="text-align:center;">n</td> <td style="text-align:center;">运行到下一行</td></tr> <tr><td style="text-align:center;">step</td> <td style="text-align:center;">s</td> <td style="text-align:center;">单步执行，遇到函数会进入</td></tr> <tr><td style="text-align:center;">until</td> <td style="text-align:center;">u</td> <td style="text-align:center;">运行到指定行停下来</td></tr> <tr><td style="text-align:center;">finish</td> <td style="text-align:center;">fi</td> <td style="text-align:center;">结束当前调用函数，回到上一层调用函数处</td></tr> <tr><td style="text-align:center;">return</td> <td style="text-align:center;">return</td> <td style="text-align:center;">结束当前调用函数并返回指定值，到上一层函数调用处</td></tr> <tr><td style="text-align:center;">jump</td> <td style="text-align:center;">j</td> <td style="text-align:center;">将当前程序执行流跳转到指定行或地址</td></tr> <tr><td style="text-align:center;">print</td> <td style="text-align:center;">p</td> <td style="text-align:center;">打印变量或寄存器值</td></tr> <tr><td style="text-align:center;">backtrace</td> <td style="text-align:center;">bt</td> <td style="text-align:center;">查看当前线程的调用堆栈</td></tr> <tr><td style="text-align:center;">frame</td> <td style="text-align:center;">f</td> <td style="text-align:center;">切换到当前调用线程的指定堆栈</td></tr> <tr><td style="text-align:center;">thread</td> <td style="text-align:center;">thread</td> <td style="text-align:center;">切换到指定线程</td></tr> <tr><td style="text-align:center;">break</td> <td style="text-align:center;">b</td> <td style="text-align:center;">添加断点</td></tr> <tr><td style="text-align:center;">tbreak</td> <td style="text-align:center;">tb</td> <td style="text-align:center;">添加临时断点</td></tr> <tr><td style="text-align:center;">delete</td> <td style="text-align:center;">d</td> <td style="text-align:center;">删除断点</td></tr> <tr><td style="text-align:center;">enable</td> <td style="text-align:center;">enable</td> <td style="text-align:center;">启用某个断点</td></tr> <tr><td style="text-align:center;">disable</td> <td style="text-align:center;">disable</td> <td style="text-align:center;">禁用某个断点</td></tr> <tr><td style="text-align:center;">watch</td> <td style="text-align:center;">watch</td> <td style="text-align:center;">监视某一个变量或内存地址的值是否发生变化</td></tr> <tr><td style="text-align:center;">list</td> <td style="text-align:center;">l</td> <td style="text-align:center;">显示源码</td></tr> <tr><td style="text-align:center;">info</td> <td style="text-align:center;">i</td> <td style="text-align:center;">查看断点 / 线程等信息</td></tr> <tr><td style="text-align:center;">ptype</td> <td style="text-align:center;">ptype</td> <td style="text-align:center;">查看变量类型</td></tr> <tr><td style="text-align:center;">disassemble</td> <td style="text-align:center;">dis</td> <td style="text-align:center;">查看汇编代码</td></tr> <tr><td style="text-align:center;">set args</td> <td style="text-align:center;">set args</td> <td style="text-align:center;">设置程序启动命令行参数</td></tr> <tr><td style="text-align:center;">show args</td> <td style="text-align:center;">show args</td> <td style="text-align:center;">查看设置的命令行参数</td></tr></tbody></table> <p>一般调试中最为常用的命令，gdb 语法糖直接回车重复执行上一条命令。</p> <table><thead><tr><th style="text-align:center;">命令名称</th> <th style="text-align:center;">命令缩写</th> <th style="text-align:center;">命令说明</th></tr></thead> <tbody><tr><td style="text-align:center;">break</td> <td style="text-align:center;">b</td> <td style="text-align:center;">添加断点</td></tr> <tr><td style="text-align:center;">run</td> <td style="text-align:center;">r</td> <td style="text-align:center;">运行一个待调试的程序</td></tr> <tr><td style="text-align:center;">next</td> <td style="text-align:center;">n</td> <td style="text-align:center;">运行到下一行（步过）</td></tr> <tr><td style="text-align:center;">step</td> <td style="text-align:center;">s</td> <td style="text-align:center;">单步执行，遇到函数会进入（步入）</td></tr> <tr><td style="text-align:center;">print</td> <td style="text-align:center;">p</td> <td style="text-align:center;">打印变量或寄存器值</td></tr> <tr><td style="text-align:center;">list</td> <td style="text-align:center;">l</td> <td style="text-align:center;">显示当前正在执行代码位置附近的代码</td></tr></tbody></table> <ol><li><p>break 打断点</p> <blockquote><ul><li><strong>break FunctionName</strong>，在函数的入口处添加一个断点；</li> <li><strong>break LineNo</strong>，在<strong>当前文件</strong>行号为<strong>LineNo</strong>处添加断点；</li> <li><strong>break FileName:LineNo</strong>，在<strong>FileName</strong>文件行号为<strong>LineNo</strong>处添加一个断点；</li> <li><strong>break FileName:FunctionName</strong>，在<strong>FileName</strong>文件的<strong>FunctionName</strong>函数的入口处添加断点；</li> <li><strong>break -/+offset</strong>，在当前程序暂停位置的前/后 offset 行处下断点；</li> <li><strong>break ... if cond</strong>，下条件断点；</li></ul></blockquote></li> <li><p>run 运行程序</p> <blockquote><p>启用GDB调试只是附加了一个调试文件，并没有启动这个程序，需要输入run命令（简写为r）启动这个程序</p></blockquote></li> <li><p>next/step 步过/步入</p> <blockquote><ul><li><p><strong>next</strong> 是 单步步过（step over），即遇到函数直接跳过，不进入函数内部。</p></li> <li><p><strong>step</strong> 是 单步步入（step into），即遇到函数会进入函数内部。</p></li></ul></blockquote></li> <li><p>print 查看变量值</p> <blockquote><ul><li><strong>print param</strong>，用于在调试过程中查看变量的值；</li> <li><strong>print param=value</strong>，用于在调试过程中修改变量的值；</li> <li><strong>print a+b+c</strong>，可以进行一定的表达式计算，这里是计算a、b、c三个变量之和；</li> <li><strong>print func()</strong>，输出<code>func</code>函数执行的结果，常见的用途是打印系统函数执行失败原因：<code>print strerror(errno)</code>；</li> <li>*<em>print <em>this</em></em>，在c++对象中，可以输出当前对象的各成员变量的值；</li> <li><strong>print arrname@arrlen</strong>，输出数组 arrname</li></ul></blockquote></li> <li><p>list 显示源码上下文</p> <blockquote><ul><li><p><strong>list</strong>，输出上一次list命令显示的代码后面的代码，如果是第一次执行list命令，则会显示当前正在执行代码位置附近的代码；</p></li> <li><p><strong>list -</strong>，带一个减号，显示上一次list命令显示的代码前面的代码；</p></li> <li><p><strong>list LineNo</strong>，显示当前代码文件第 <strong>LineNo</strong> 行附近的代码；</p></li> <li><p><strong>list FileName:LineNo</strong>，显示 <strong>FileName</strong> 文件第 <strong>LineNo</strong> 行附近的代码；</p></li> <li><p><strong>list FunctionName</strong>，显示当前文件的 <strong>FunctionName</strong> 函数附近的代码；</p></li> <li><p><strong>list FileName:FunctionName</strong>，显示 <strong>FileName</strong> 文件的 <strong>FunctionName</strong> 函数附件的代码；</p></li> <li><p><strong>list from,to</strong>，其中<strong>from</strong>和<strong>to</strong>是具体的代码位置，显示这之间的代码；</p></li></ul> <p><strong>list</strong>命令默认只会输出 <strong>10</strong> 行源代码，也可以使用如下命令修改：</p> <ul><li><strong>show listsize</strong>，查看 <strong>list</strong> 命令显示的代码行数；</li> <li><strong>set listsize count</strong>，设置 <strong>list</strong> 命令显示的代码行数为 <strong>count</strong>;</li></ul></blockquote></li></ol> <h2 id="_1-3-gdb-基础调试实例"><a href="#_1-3-gdb-基础调试实例" class="header-anchor">#</a> 1.3 GDB 基础调试实例</h2> <p>下面结合一个例子熟悉常用的 gdb 调试命令，例子如下：</p> <p>代码定义了一个静态整型变量<code>param</code>，并初始化为1。</p> <p>然后定义了两个分别名为<code>func1</code>和<code>func2</code>的函数，它接收两个参数 <code>var</code>和<code>val</code>，并试图在 将 <code>var</code>的值修改为<code>val</code>。但是<code>func1</code>中<strong>形参是值传递</strong>，函数外部无法实现参数值的修改；<code>func2</code>中<strong>形参是引用传递</strong>，能够完成参数值修改。</p> <p>最后定义了主函数<code>main</code>，调用<code>func</code>函数，将<code>i</code>的值改为1，并将<code>param</code>加上<code>i</code>的值。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>

<span class="token keyword">static</span> <span class="token keyword">int</span> param <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token keyword">int</span> var<span class="token punctuation">,</span> <span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token punctuation">{</span>
    var <span class="token operator">=</span> val<span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;function func1 has been called!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>var<span class="token punctuation">,</span> <span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token operator">*</span>var <span class="token operator">=</span> val<span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;function func2 has been called!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token function">func1</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">func2</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    param <span class="token operator">+=</span> i<span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;function main has been called!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>首先编译该程序并启用 GDB 调试</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ gcc <span class="token parameter variable">-g</span> basic.c <span class="token parameter variable">-o</span> basic
$ gdb basic 
GNU gdb <span class="token punctuation">(</span>Ubuntu <span class="token number">12.1</span>-0ubuntu1~22.04<span class="token punctuation">)</span> <span class="token number">12.1</span>
Copyright <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2022</span> Free Software Foundation, Inc.
License GPLv3+: GNU GPL version <span class="token number">3</span> or later <span class="token operator">&lt;</span>http://gnu.org/licenses/gpl.html<span class="token operator">&gt;</span>
This is <span class="token function">free</span> software: you are <span class="token function">free</span> to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type <span class="token string">&quot;show copying&quot;</span> and <span class="token string">&quot;show warranty&quot;</span> <span class="token keyword">for</span> details.
This GDB was configured as <span class="token string">&quot;x86_64-linux-gnu&quot;</span><span class="token builtin class-name">.</span>
Type <span class="token string">&quot;show configuration&quot;</span> <span class="token keyword">for</span> configuration details.
For bug reporting instructions, please see:
<span class="token operator">&lt;</span>https://www.gnu.org/software/gdb/bugs/<span class="token operator">&gt;</span>.
Find the GDB manual and other documentation resources online at:
    <span class="token operator">&lt;</span>http://www.gnu.org/software/gdb/documentation/<span class="token operator">&gt;</span>.

For help, <span class="token builtin class-name">type</span> <span class="token string">&quot;help&quot;</span><span class="token builtin class-name">.</span>
Type <span class="token string">&quot;apropos word&quot;</span> to search <span class="token keyword">for</span> commands related to <span class="token string">&quot;word&quot;</span><span class="token punctuation">..</span>.
Reading symbols from basic<span class="token punctuation">..</span>.
</code></pre></div><p>使用 b 命令将断点打在 <code>main</code> 函数入口，并使用 r 命令运行程序</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b main
Breakpoint <span class="token number">1</span> at 0x11d7: <span class="token function">file</span> basic.c, line <span class="token number">15</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> r
Starting program: /home/randy/study/dev-tool/gdb/basic 
<span class="token punctuation">[</span>Thread debugging using libthread_db enabled<span class="token punctuation">]</span>
Using <span class="token function">host</span> libthread_db library <span class="token string">&quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;</span><span class="token builtin class-name">.</span>

Breakpoint <span class="token number">1</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at basic.c:15
<span class="token number">15</span>      int <span class="token function-name function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
</code></pre></div><p>使用 n 命令执行下一行语句，遇到函数直接跳过不进入；使用 s 命令步入函数 <code>func1(i,1);</code>，并使用 l 命令查看当前语句在源码中的上下文。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">17</span>          int i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token number">18</span>          func1<span class="token punctuation">(</span>i, <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> s
func1 <span class="token punctuation">(</span>var<span class="token operator">=</span><span class="token number">0</span>, <span class="token assign-left variable">val</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> at basic.c:6
<span class="token number">6</span>           var <span class="token operator">=</span> val<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> l
<span class="token number">1</span>       <span class="token comment">#include&lt;stdio.h&gt;</span>
<span class="token number">2</span>
<span class="token number">3</span>       static int param <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token number">4</span>
<span class="token number">5</span>       void func1<span class="token punctuation">(</span>int var, int val<span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token number">6</span>           var <span class="token operator">=</span> val<span class="token punctuation">;</span>
<span class="token number">7</span>           printf<span class="token punctuation">(</span><span class="token string">&quot;function func1 has been called!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">8</span>       <span class="token punctuation">}</span>
<span class="token number">9</span>
<span class="token number">10</span>      void func2<span class="token punctuation">(</span>int *var, int val<span class="token punctuation">)</span><span class="token punctuation">{</span>
</code></pre></div><p>使用 p 命令查看 <code>func1(var, val)</code> 中 var 在修改前后的值，并查看在 <code>func1</code>  函数执行完成之后，传入的实参 <code>i</code> 的值未完成修改，仍为 0；</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p var
<span class="token variable">$1</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">7</span>           printf<span class="token punctuation">(</span><span class="token string">&quot;function func1 has been called!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p var
<span class="token variable">$2</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">8</span>       <span class="token punctuation">}</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
main <span class="token punctuation">(</span><span class="token punctuation">)</span> at basic.c:19
<span class="token number">19</span>          func2<span class="token punctuation">(</span><span class="token operator">&amp;</span>i, <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p i
<span class="token variable">$3</span> <span class="token operator">=</span> <span class="token number">0</span>
</code></pre></div><p>使用 n 命令步过可以完成 <code>i</code> 值修改的函数 <code>func2</code>，并查看修改之后的值为 1</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
main <span class="token punctuation">(</span><span class="token punctuation">)</span> at basic.c:19
<span class="token number">19</span>          func2<span class="token punctuation">(</span><span class="token operator">&amp;</span>i, <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p i
<span class="token variable">$3</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">20</span>          param <span class="token operator">+=</span> i<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p i
<span class="token variable">$4</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p param
<span class="token variable">$5</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">21</span>          printf<span class="token punctuation">(</span><span class="token string">&quot;function main has been called!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p param
<span class="token variable">$6</span> <span class="token operator">=</span> <span class="token number">2</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">23</span>          <span class="token builtin class-name">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">24</span>      <span class="token punctuation">}</span>
</code></pre></div><p>上述完整 gdb 调试过程如下：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ gdb gcc <span class="token parameter variable">-g</span> basic.c <span class="token parameter variable">-o</span> basic   
$ gdb gdb basic 
GNU gdb <span class="token punctuation">(</span>Ubuntu <span class="token number">12.1</span>-0ubuntu1~22.04<span class="token punctuation">)</span> <span class="token number">12.1</span>
Copyright <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2022</span> Free Software Foundation, Inc.
License GPLv3+: GNU GPL version <span class="token number">3</span> or later <span class="token operator">&lt;</span>http://gnu.org/licenses/gpl.html<span class="token operator">&gt;</span>
This is <span class="token function">free</span> software: you are <span class="token function">free</span> to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type <span class="token string">&quot;show copying&quot;</span> and <span class="token string">&quot;show warranty&quot;</span> <span class="token keyword">for</span> details.
This GDB was configured as <span class="token string">&quot;x86_64-linux-gnu&quot;</span><span class="token builtin class-name">.</span>
Type <span class="token string">&quot;show configuration&quot;</span> <span class="token keyword">for</span> configuration details.
For bug reporting instructions, please see:
<span class="token operator">&lt;</span>https://www.gnu.org/software/gdb/bugs/<span class="token operator">&gt;</span>.
Find the GDB manual and other documentation resources online at:
<span class="token parameter variable">--Type</span> <span class="token operator">&lt;</span>RET<span class="token operator">&gt;</span> <span class="token keyword">for</span> more, q to quit, c to <span class="token builtin class-name">continue</span> without paging--
    <span class="token operator">&lt;</span>http://www.gnu.org/software/gdb/documentation/<span class="token operator">&gt;</span>.

For help, <span class="token builtin class-name">type</span> <span class="token string">&quot;help&quot;</span><span class="token builtin class-name">.</span>
Type <span class="token string">&quot;apropos word&quot;</span> to search <span class="token keyword">for</span> commands related to <span class="token string">&quot;word&quot;</span><span class="token punctuation">..</span>.
Reading symbols from basic<span class="token punctuation">..</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b main
Breakpoint <span class="token number">1</span> at 0x11d7: <span class="token function">file</span> basic.c, line <span class="token number">15</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> r
Starting program: /home/randy/study/dev-tool/gdb/basic 
<span class="token punctuation">[</span>Thread debugging using libthread_db enabled<span class="token punctuation">]</span>
Using <span class="token function">host</span> libthread_db library <span class="token string">&quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;</span><span class="token builtin class-name">.</span>

Breakpoint <span class="token number">1</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at basic.c:15
<span class="token number">15</span>      int <span class="token function-name function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">17</span>          int i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token number">18</span>          func1<span class="token punctuation">(</span>i, <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> s
func1 <span class="token punctuation">(</span>var<span class="token operator">=</span><span class="token number">0</span>, <span class="token assign-left variable">val</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> at basic.c:6
<span class="token number">6</span>           var <span class="token operator">=</span> val<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> l
<span class="token number">1</span>       <span class="token comment">#include&lt;stdio.h&gt;</span>
<span class="token number">2</span>
<span class="token number">3</span>       static int param <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token number">4</span>
<span class="token number">5</span>       void func1<span class="token punctuation">(</span>int var, int val<span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token number">6</span>           var <span class="token operator">=</span> val<span class="token punctuation">;</span>
<span class="token number">7</span>           printf<span class="token punctuation">(</span><span class="token string">&quot;function func1 has been called!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">8</span>       <span class="token punctuation">}</span>
<span class="token number">9</span>
<span class="token number">10</span>      void func2<span class="token punctuation">(</span>int *var, int val<span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p var
<span class="token variable">$1</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">7</span>           printf<span class="token punctuation">(</span><span class="token string">&quot;function func1 has been called!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p var
<span class="token variable">$2</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">8</span>       <span class="token punctuation">}</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
main <span class="token punctuation">(</span><span class="token punctuation">)</span> at basic.c:19
<span class="token number">19</span>          func2<span class="token punctuation">(</span><span class="token operator">&amp;</span>i, <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p i
<span class="token variable">$3</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">20</span>          param <span class="token operator">+=</span> i<span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p i
<span class="token variable">$4</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p param
<span class="token variable">$5</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">21</span>          printf<span class="token punctuation">(</span><span class="token string">&quot;function main has been called!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p param
<span class="token variable">$6</span> <span class="token operator">=</span> <span class="token number">2</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">23</span>          <span class="token builtin class-name">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">24</span>      <span class="token punctuation">}</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
</code></pre></div><h1 id="_02-gdb-调试多进程程序"><a href="#_02-gdb-调试多进程程序" class="header-anchor">#</a> 02 GDB 调试多进程程序</h1> <h2 id="_2-1-多进程调试中常用的-gdb-命令"><a href="#_2-1-多进程调试中常用的-gdb-命令" class="header-anchor">#</a> 2.1 多进程调试中常用的 GDB 命令</h2> <table><thead><tr><th style="text-align:center;">命令名称</th> <th style="text-align:center;">命令缩写</th> <th style="text-align:center;">命令说明</th></tr></thead> <tbody><tr><td style="text-align:center;">set follow-fork-mode</td> <td style="text-align:center;"></td> <td style="text-align:center;">设置需要跟踪的子进程</td></tr> <tr><td style="text-align:center;">set detach-on-fork</td> <td style="text-align:center;"></td> <td style="text-align:center;">设置在程序运行时是否将调试器与进程分离</td></tr> <tr><td style="text-align:center;">attach</td> <td style="text-align:center;"></td> <td style="text-align:center;">附加到正在运行的进程进行调试</td></tr> <tr><td style="text-align:center;">detach</td> <td style="text-align:center;"></td> <td style="text-align:center;">从正在调试的进程中分离gdb调试器</td></tr> <tr><td style="text-align:center;">inferior</td> <td style="text-align:center;"></td> <td style="text-align:center;">切换到另一个进程上下文进行调试</td></tr> <tr><td style="text-align:center;">continue</td> <td style="text-align:center;">c</td> <td style="text-align:center;">继续执行程序，直到下一个断点或程序结束</td></tr> <tr><td style="text-align:center;">backtrace</td> <td style="text-align:center;">bt</td> <td style="text-align:center;">显示函数调用栈</td></tr> <tr><td style="text-align:center;">frame</td> <td style="text-align:center;">f</td> <td style="text-align:center;">切换到指定堆栈</td></tr> <tr><td style="text-align:center;">set args</td> <td style="text-align:center;"></td> <td style="text-align:center;">设置程序启动命令行参数</td></tr> <tr><td style="text-align:center;">show args</td> <td style="text-align:center;"></td> <td style="text-align:center;">查看设置的命令行参数</td></tr></tbody></table> <ol><li><p>set follow-fork-mode [parent/child] 指定需要跟踪的子进程</p> <blockquote><p><code>set follow-fork-mode</code>命令必须在程序开始执行前设置才能生效。如果在程序启动后再设置该命令，则不会影响当前正在进行的调试会话。该命令 <code>set follow-fork-mode MODE</code> 可以指定以下三种模式：</p> <ul><li><code>parent</code>：只跟踪父进程，fork 之后继续调试父进程，子进程不受影响</li> <li><code>child</code>：只跟踪子进程，fork之后调试子进程，父进程不受影响</li> <li><code>ask</code>：每次 fork 时询问用户选择</li></ul></blockquote></li> <li><p>set detach-on-fork [on/off]是否将调试器与进程分离</p> <blockquote><ul><li><p><strong>on</strong>， 调试器将与新进程分离，以便在进程创建新进程时能够安全地停止和调试新进程，原进程会继续执行，直到调试器与新进程分离为止</p></li> <li><p><strong>off</strong>，调试器将与新进程紧密关联，一直跟随新进程的执行，原进程不会等待新进程完成复制执行环境后才会重新启动</p></li></ul></blockquote></li> <li><p>attach/detach 附加/分离指定进程</p> <blockquote><ul><li><p><strong>attach [PID]</strong>， 让 gdb 附加到已经在运行的进程上进行调试</p></li> <li><p><strong>detach [PID]</strong>，从正在调试的进程中分离gdb调试器</p></li></ul></blockquote></li> <li><p>inferior 切换到不同的进程上下文进行调试</p> <blockquote><p><strong>inferior [PID | PNAME]</strong>，其中<code>PID</code>为进程编号，<code>PNAME</code>为进程名称。</p></blockquote></li> <li><p>continue 终端程序后继续执行</p> <blockquote><p>当GDB触发断点或者使用 Ctrl + C 命令中断下来后，想让程序继续运行，只要输入 continue（简写为c）命令即可</p></blockquote></li> <li><p>bt/f 显示/切换函数调用栈</p> <blockquote><ul><li><strong>backtrace</strong>，也可简写为 <strong>bt</strong>，用于查看当前调用堆栈</li> <li><strong>frame 堆栈编号</strong>，也可简写为 <strong>f 堆栈编号</strong>，用于切换到其他堆栈处</li></ul></blockquote></li> <li><p>set/show args 设置/查看命令行参数</p> <blockquote><ul><li><strong>set args args1</strong>，设置单个启动参数 <strong>args1</strong>；</li> <li><strong>set args &quot;-p&quot; &quot;password&quot;</strong>，如果单个参数之间有空格，可以使用引号将参数包裹起来；</li> <li><strong>set args args1 args2 args3</strong>，设置多个启动参数，参数之间用空格隔开；</li> <li><strong>set args</strong>，不带参数，则清除之前设置的参数；</li></ul></blockquote></li></ol> <h2 id="_2-2-gdb-多进程调试实例"><a href="#_2-2-gdb-多进程调试实例" class="header-anchor">#</a> 2.2 GDB 多进程调试实例</h2> <p>下面结合一个例子介绍 gdb 调试多进程程序，例子如下：</p> <p>程序首先创建了一个管道，然后通过<code>fork()</code>函数创建了两个子进程。</p> <p>在第一个子进程中，它向管道的写端写入了一条消息，然后退出；在第二个子进程中，它从管道的读端读取了这条消息，并将其打印出来，然后退出。</p> <p>父进程在创建完子进程后，关闭了管道的读端和写端，并分别等待两个子进程结束。</p> <p>当两个子进程都结束时，父进程才会继续执行，并打印一条消息表示所有子进程都已完成。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> pipefd<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// 管道描述符数组</span>
    <span class="token class-name">pid_t</span> pid1<span class="token punctuation">,</span> pid2<span class="token punctuation">;</span>  <span class="token comment">// 子进程ID变量</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">pipe</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 创建管道</span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">&quot;pipe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    pid1 <span class="token operator">=</span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 创建第一个子进程</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pid1 <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">&quot;fork&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>pid1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 在第一个子进程中</span>
        <span class="token function">close</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 关闭读端</span>
        <span class="token keyword">char</span> msg<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Hello, I'm child process 1!&quot;</span><span class="token punctuation">;</span>
        <span class="token function">write</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> msg<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 向写端写入消息</span>
        <span class="token function">close</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 关闭写端</span>
        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_SUCCESS<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> 

    pid2 <span class="token operator">=</span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 创建第二个子进程</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pid2 <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">&quot;fork&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>pid2 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 在第二个子进程中</span>
        <span class="token function">close</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 关闭写端</span>
        <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">read</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 从读端读取消息</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;This is child process 2. Received message from child process 1: %s\n&quot;</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">close</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 关闭读端</span>
        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_SUCCESS<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 父进程中</span>
    <span class="token function">close</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 关闭读端</span>
    <span class="token function">close</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 关闭写端</span>
    <span class="token function">waitpid</span><span class="token punctuation">(</span>pid1<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 等待第一个子进程结束</span>
    <span class="token function">waitpid</span><span class="token punctuation">(</span>pid2<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 等待第二个子进程结束</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;All child processes have completed.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-2-1-调试父进程"><a href="#_2-2-1-调试父进程" class="header-anchor">#</a> 2.2.1 调试父进程</h3> <p>首先编译该程序并启用 GDB 调试</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ gdb gcc <span class="token parameter variable">-g</span> multi_process.c <span class="token parameter variable">-o</span> multi_process   
$ gdb gdb multi_process 
GNU gdb <span class="token punctuation">(</span>Ubuntu <span class="token number">12.1</span>-0ubuntu1~22.04<span class="token punctuation">)</span> <span class="token number">12.1</span>
Copyright <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2022</span> Free Software Foundation, Inc.
License GPLv3+: GNU GPL version <span class="token number">3</span> or later <span class="token operator">&lt;</span>http://gnu.org/licenses/gpl.html<span class="token operator">&gt;</span>
This is <span class="token function">free</span> software: you are <span class="token function">free</span> to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type <span class="token string">&quot;show copying&quot;</span> and <span class="token string">&quot;show warranty&quot;</span> <span class="token keyword">for</span> details.
This GDB was configured as <span class="token string">&quot;x86_64-linux-gnu&quot;</span><span class="token builtin class-name">.</span>
Type <span class="token string">&quot;show configuration&quot;</span> <span class="token keyword">for</span> configuration details.
For bug reporting instructions, please see:
<span class="token operator">&lt;</span>https://www.gnu.org/software/gdb/bugs/<span class="token operator">&gt;</span>.
Find the GDB manual and other documentation resources online at:
    <span class="token operator">&lt;</span>http://www.gnu.org/software/gdb/documentation/<span class="token operator">&gt;</span>.

For help, <span class="token builtin class-name">type</span> <span class="token string">&quot;help&quot;</span><span class="token builtin class-name">.</span>
Type <span class="token string">&quot;apropos word&quot;</span> to search <span class="token keyword">for</span> commands related to <span class="token string">&quot;word&quot;</span><span class="token punctuation">..</span>.
Reading symbols from multi_process<span class="token punctuation">..</span>.
</code></pre></div><p><strong>set follow-fork-mode parent 设置仅跟踪父进程</strong>（也可以直接跳过这个步骤，默认 parent）；使用 b 命令将断点打在 <code>main</code> 函数入口；并使用 r 命令运行程序。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">set</span> follow-fork-mode parent
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b main
Breakpoint <span class="token number">1</span> at 0x4007f8: <span class="token function">file</span> multi_process.c, line <span class="token number">11</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> r
Starting program: /home/randy/study/dev-tool/gdb/multi_process 
<span class="token punctuation">[</span>Thread debugging using libthread_db enabled<span class="token punctuation">]</span>
Using <span class="token function">host</span> libthread_db library <span class="token string">&quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;</span><span class="token builtin class-name">.</span>

Breakpoint <span class="token number">1</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at multi_process.c:7
<span class="token number">7</span>       int <span class="token function-name function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

</code></pre></div><p>使用 n 命令单步执行，查看程序执行情况，可以看到<strong>第一个子进程</strong>在被 fork 成功之后就从 gdb 调试中分离并继续执行了 <code>[Detaching after fork from child process 20228]</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">16</span>          pid1 <span class="token operator">=</span> fork<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  // 创建第一个子进程
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p pid1
<span class="token variable">$1</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token punctuation">[</span>Detaching after fork from child process <span class="token number">20228</span><span class="token punctuation">]</span>
<span class="token number">17</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>pid1 <span class="token operator">==</span> -1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token number">22</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>pid1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  // 在第一个子进程中
</code></pre></div><p>同样的继续使用 n 命令单步执行，可以看到第二个子进程在被 fork 成功之后也从 gdb 调试中分离 <code>[Detaching after fork from child process 20415]</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token number">30</span>          pid2 <span class="token operator">=</span> fork<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  // 创建第二个子进程
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p pid2
<span class="token variable">$2</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token punctuation">[</span>Detaching after fork from child process <span class="token number">20415</span><span class="token punctuation">]</span>
<span class="token comment"># 第二个子进程执行完成读取第一个子进程发送的消息并打印如下输出</span>
This is child process <span class="token number">2</span>. Received message from child process <span class="token number">1</span>: Hello, I'm child process <span class="token number">1</span><span class="token operator">!</span>
<span class="token number">31</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>pid2 <span class="token operator">==</span> -1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token number">36</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>pid2 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  // 在第二个子进程中
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token number">46</span>          close<span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  // 关闭读端
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token number">47</span>          close<span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  // 关闭写端
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token number">48</span>          waitpid<span class="token punctuation">(</span>pid1, NULL, <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  // 等待第一个子进程结束
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token number">49</span>          waitpid<span class="token punctuation">(</span>pid2, NULL, <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  // 等待第二个子进程结束
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token number">50</span>          printf<span class="token punctuation">(</span><span class="token string">&quot;All child processes have completed.<span class="token entity" title="\n">\n</span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
All child processes have completed.
<span class="token number">52</span>          <span class="token builtin class-name">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-2-2-调试第一个子进程"><a href="#_2-2-2-调试第一个子进程" class="header-anchor">#</a> 2.2.2 调试第一个子进程</h3> <p>首先编译该程序并启用 GDB 调试</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ gdb gcc <span class="token parameter variable">-g</span> multi_process.c <span class="token parameter variable">-o</span> multi_process   
$ gdb gdb multi_process 
GNU gdb <span class="token punctuation">(</span>Ubuntu <span class="token number">12.1</span>-0ubuntu1~22.04<span class="token punctuation">)</span> <span class="token number">12.1</span>
Copyright <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2022</span> Free Software Foundation, Inc.
License GPLv3+: GNU GPL version <span class="token number">3</span> or later <span class="token operator">&lt;</span>http://gnu.org/licenses/gpl.html<span class="token operator">&gt;</span>
This is <span class="token function">free</span> software: you are <span class="token function">free</span> to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type <span class="token string">&quot;show copying&quot;</span> and <span class="token string">&quot;show warranty&quot;</span> <span class="token keyword">for</span> details.
This GDB was configured as <span class="token string">&quot;x86_64-linux-gnu&quot;</span><span class="token builtin class-name">.</span>
Type <span class="token string">&quot;show configuration&quot;</span> <span class="token keyword">for</span> configuration details.
For bug reporting instructions, please see:
<span class="token operator">&lt;</span>https://www.gnu.org/software/gdb/bugs/<span class="token operator">&gt;</span>.
Find the GDB manual and other documentation resources online at:
    <span class="token operator">&lt;</span>http://www.gnu.org/software/gdb/documentation/<span class="token operator">&gt;</span>.

For help, <span class="token builtin class-name">type</span> <span class="token string">&quot;help&quot;</span><span class="token builtin class-name">.</span>
Type <span class="token string">&quot;apropos word&quot;</span> to search <span class="token keyword">for</span> commands related to <span class="token string">&quot;word&quot;</span><span class="token punctuation">..</span>.
Reading symbols from multi_process<span class="token punctuation">..</span>.
</code></pre></div><p><strong>set follow-fork-mode child 设置跟踪子进程</strong>，使用 b 命令将断点打在 <code>main</code> 函数入口，并使用 r 命令运行程序</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">set</span> follow-fork-mode child
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b main
Breakpoint <span class="token number">1</span> at 0x12b8: <span class="token function">file</span> multi_process.c, line <span class="token number">7</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> r
Starting program: /home/randy/study/dev-tool/gdb/multi_process 
<span class="token punctuation">[</span>Thread debugging using libthread_db enabled<span class="token punctuation">]</span>
Using <span class="token function">host</span> libthread_db library <span class="token string">&quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;</span><span class="token builtin class-name">.</span>

Breakpoint <span class="token number">1</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at multi_process.c:7
<span class="token number">7</span>       int <span class="token function-name function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</code></pre></div><p>n 单步执行程序，直到第一个子进程 pid1=0</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">11</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>pipe<span class="token punctuation">(</span>pipefd<span class="token punctuation">)</span> <span class="token operator">==</span> -1<span class="token punctuation">)</span> <span class="token punctuation">{</span>  // 创建管道
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token number">16</span>          pid1 <span class="token operator">=</span> fork<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  // 创建第一个子进程
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p pid1
<span class="token variable">$1</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token punctuation">[</span>Attaching after Thread 0x7ffff7d8c740 <span class="token punctuation">(</span>LWP <span class="token number">5001</span><span class="token punctuation">)</span> fork to child process <span class="token number">5166</span><span class="token punctuation">]</span> <span class="token comment"># 表示gdb正在附加到一个已经fork出子进程的父进程中</span>
<span class="token punctuation">[</span>New inferior <span class="token number">2</span> <span class="token punctuation">(</span>process <span class="token number">5166</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># 表示gdb创建了一个新的被调试进程，并将其编号设置为2，该进程的PID为5166</span>
<span class="token punctuation">[</span>Detaching after fork from parent process <span class="token number">5001</span><span class="token punctuation">]</span> <span class="token comment"># 表示gdb从父进程中分离出子进程，将其作为独立的被调试进程进行调试</span>
<span class="token punctuation">[</span>Inferior <span class="token number">1</span> <span class="token punctuation">(</span>process <span class="token number">5001</span><span class="token punctuation">)</span> detached<span class="token punctuation">]</span> <span class="token comment"># 表示gdb已经从原始的父进程中分离出来，成为一个独立的进程（或线程）控制器。由于该进程的编号为1，因此显示为Inferior 1</span>
<span class="token punctuation">[</span>Thread debugging using libthread_db enabled<span class="token punctuation">]</span> <span class="token comment"># 表示gdb使用libthread_db库来进行线程调试</span>
Using <span class="token function">host</span> libthread_db library <span class="token string">&quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;</span><span class="token builtin class-name">.</span>
<span class="token punctuation">[</span>Switching to Thread 0x7ffff7d8c740 <span class="token punctuation">(</span>LWP <span class="token number">5166</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># 表示gdb正在切换到子进程的线程上进行调试</span>
main <span class="token punctuation">(</span><span class="token punctuation">)</span> at multi_process.c:17
<span class="token number">17</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>pid1 <span class="token operator">==</span> -1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</code></pre></div><p>在子进程中 使用 n 命令单步执行并观察变量值，由于 set follow-fork-mode child 只跟踪子进程，在上一步中 <code>[Inferior 1 (process 5001) detached]</code> 表示 gdb 已经<strong>将父进程分离并继续执行</strong>，所以在下面的内容中第一个子进程写完消息之后，第二个子进程就收到了消息并在打印后退出了。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">22</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>pid1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  // 在第一个子进程中
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token number">23</span>              close<span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  // 关闭读端
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token number">24</span>              char msg<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Hello, I'm child process 1!&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p msg
<span class="token variable">$1</span> <span class="token operator">=</span> &quot;`<span class="token punctuation">\</span><span class="token number">317</span><span class="token punctuation">\</span><span class="token number">377</span><span class="token punctuation">\</span><span class="token number">367</span><span class="token punctuation">\</span><span class="token number">377</span><span class="token punctuation">\</span><span class="token number">177</span><span class="token punctuation">\</span>000<span class="token punctuation">\</span>000<span class="token punctuation">\</span>330J<span class="token punctuation">\</span><span class="token number">374</span><span class="token punctuation">\</span><span class="token number">367</span><span class="token punctuation">\</span><span class="token number">377</span><span class="token punctuation">\</span><span class="token number">177</span><span class="token punctuation">\</span>000<span class="token punctuation">\</span>000<span class="token punctuation">\</span>000<span class="token punctuation">\</span>000<span class="token punctuation">\</span>000<span class="token punctuation">\</span>000<span class="token punctuation">\</span>000<span class="token punctuation">\</span>000<span class="token punctuation">\</span>000<span class="token punctuation">\</span>000<span class="token punctuation">\</span>060<span class="token punctuation">\</span><span class="token number">334</span><span class="token punctuation">\</span><span class="token number">377</span><span class="token punctuation">\</span><span class="token number">377</span>&quot;
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">25</span>              write<span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>, msg, strlen<span class="token punctuation">(</span>msg<span class="token punctuation">))</span><span class="token punctuation">;</span>  // 向写端写入消息
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
This is child process <span class="token number">2</span>. Received message from child process <span class="token number">1</span>: Hello, I'm child process <span class="token number">1</span><span class="token operator">!</span>
<span class="token number">26</span>              close<span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  // 关闭写端
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token number">27</span>              exit<span class="token punctuation">(</span>EXIT_SUCCESS<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token punctuation">[</span>Inferior <span class="token number">2</span> <span class="token punctuation">(</span>process <span class="token number">6971</span><span class="token punctuation">)</span> exited normally<span class="token punctuation">]</span>
All child processes have completed.
</code></pre></div><h3 id="_2-2-3-调试第二个子进程"><a href="#_2-2-3-调试第二个子进程" class="header-anchor">#</a> 2.2.3 调试第二个子进程</h3> <p>首先编译该程序并启用 GDB 调试</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ gdb gcc <span class="token parameter variable">-g</span> multi_process.c <span class="token parameter variable">-o</span> multi_process   
$ gdb gdb multi_process 
GNU gdb <span class="token punctuation">(</span>Ubuntu <span class="token number">12.1</span>-0ubuntu1~22.04<span class="token punctuation">)</span> <span class="token number">12.1</span>
Copyright <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2022</span> Free Software Foundation, Inc.
License GPLv3+: GNU GPL version <span class="token number">3</span> or later <span class="token operator">&lt;</span>http://gnu.org/licenses/gpl.html<span class="token operator">&gt;</span>
This is <span class="token function">free</span> software: you are <span class="token function">free</span> to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type <span class="token string">&quot;show copying&quot;</span> and <span class="token string">&quot;show warranty&quot;</span> <span class="token keyword">for</span> details.
This GDB was configured as <span class="token string">&quot;x86_64-linux-gnu&quot;</span><span class="token builtin class-name">.</span>
Type <span class="token string">&quot;show configuration&quot;</span> <span class="token keyword">for</span> configuration details.
For bug reporting instructions, please see:
<span class="token operator">&lt;</span>https://www.gnu.org/software/gdb/bugs/<span class="token operator">&gt;</span>.
Find the GDB manual and other documentation resources online at:
    <span class="token operator">&lt;</span>http://www.gnu.org/software/gdb/documentation/<span class="token operator">&gt;</span>.

For help, <span class="token builtin class-name">type</span> <span class="token string">&quot;help&quot;</span><span class="token builtin class-name">.</span>
Type <span class="token string">&quot;apropos word&quot;</span> to search <span class="token keyword">for</span> commands related to <span class="token string">&quot;word&quot;</span><span class="token punctuation">..</span>.
Reading symbols from multi_process<span class="token punctuation">..</span>.
</code></pre></div><p>先设置跟踪父进程 <strong>set follow-fork-mode parent</strong> 来跳过第一个子进程的 fork 操作；使用 b 命令将断点<strong>打在创建第二个子进程的 fork 函数之前</strong>；并使用 r 命令运行程序。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">set</span> follow-fork-mode parent
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b multi_process.c:22
Breakpoint <span class="token number">1</span> at 0x40083f: <span class="token function">file</span> multi_process.c, line <span class="token number">22</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> r
Starting program: /home/randy/study/dev-tool/gdb/multi_process 
<span class="token punctuation">[</span>Detaching after fork from child process <span class="token number">25249</span><span class="token punctuation">]</span> <span class="token comment"># 分离第一个子进程</span>

Breakpoint <span class="token number">1</span>, main <span class="token punctuation">(</span><span class="token punctuation">)</span> at multi_process.c:22
<span class="token number">22</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>pid1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  // 在第一个子进程中
</code></pre></div><p>在继续执行程序前 <strong>set follow-fork-mode child</strong> 设置 gdb 调试跟踪子进程，然后再使用 n 命令单步执行 fork 创建第二个子进程，可以看到第二个子进程在被 fork 成功之后，gdb 调试就分离的父进程，并切换到第二个子进程中。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">set</span> follow-fork-mode child
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">30</span>          pid2 <span class="token operator">=</span> fork<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  // 创建第二个子进程
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token punctuation">[</span>Attaching after process <span class="token number">25358</span> fork to child process <span class="token number">25358</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span>New inferior <span class="token number">2</span> <span class="token punctuation">(</span>process <span class="token number">25358</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span>Detaching after fork from parent process <span class="token number">25245</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span>Inferior <span class="token number">1</span> <span class="token punctuation">(</span>process <span class="token number">25245</span><span class="token punctuation">)</span> detached<span class="token punctuation">]</span> <span class="token comment"># 已经分离父进程</span>
<span class="token punctuation">[</span>Switching to process <span class="token number">25358</span><span class="token punctuation">]</span> <span class="token comment"># 切换到第二个子进程</span>
<span class="token number">31</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>pid2 <span class="token operator">==</span> -1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</code></pre></div><p>进入第二个子进程后，就可以使用 n 命令单步执行程序，使用 p 命令查看变量值。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">36</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>pid2 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  // 在第二个子进程中
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p pid2
<span class="token variable">$1</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">37</span>              close<span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  // 关闭写端
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">39</span>              read<span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>, buf, sizeof<span class="token punctuation">(</span>buf<span class="token punctuation">))</span><span class="token punctuation">;</span>  // 从读端读取消息
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">40</span>              printf<span class="token punctuation">(</span><span class="token string">&quot;This is child process 2. Received message from child process 1: %s<span class="token entity" title="\n">\n</span>&quot;</span>, buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p buf
<span class="token variable">$2</span> <span class="token operator">=</span> <span class="token string">&quot;Hello, I'm child process 1!&quot;</span>, <span class="token string">'\000'</span> <span class="token operator">&lt;</span>repeats <span class="token number">477</span> times<span class="token operator">&gt;</span><span class="token punctuation">..</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
This is child process <span class="token number">2</span>. Received message from child process <span class="token number">1</span>: Hello, I'm child process <span class="token number">1</span><span class="token operator">!</span>
<span class="token number">41</span>              close<span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  // 关闭读端
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">42</span>              exit<span class="token punctuation">(</span>EXIT_SUCCESS<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> 
<span class="token punctuation">[</span>Inferior <span class="token number">2</span> <span class="token punctuation">(</span>process <span class="token number">25358</span><span class="token punctuation">)</span> exited normally<span class="token punctuation">]</span>
All child processes have completed.
</code></pre></div></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/11/19, 12:55:48</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/028d7e/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">目录</div></a> <a href="/pages/2f33c0/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">GDB调试Coredump</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/028d7e/" class="prev">目录</a></span> <span class="next"><a href="/pages/2f33c0/">GDB调试Coredump</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:wanghaihua@hust.edu.cn" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/wang-haihua" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://randy.blog.csdn.net/" title="CSDN" target="_blank" class="iconfont icon-csdn"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2024
    <span>Wang Qinghuan | MIT License</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.3c964c09.js" defer></script><script src="/assets/js/2.7cb4c100.js" defer></script><script src="/assets/js/139.4153d23d.js" defer></script>
  </body>
</html>
