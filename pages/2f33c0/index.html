<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>GDB调试Coredump | 王清欢Randy</title>
    <meta name="generator" content="VuePress 1.9.2">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="解决问题，担当责任，优雅生活。">
    <meta name="keywords" content="vuepress,it,blog">
    <meta name="theme-color" content="#cf2825">
    
    <link rel="preload" href="/assets/css/0.styles.ded236f3.css" as="style"><link rel="preload" href="/assets/js/app.3c964c09.js" as="script"><link rel="preload" href="/assets/js/2.7cb4c100.js" as="script"><link rel="preload" href="/assets/js/140.c25d78fc.js" as="script"><link rel="prefetch" href="/assets/js/10.63f63ae7.js"><link rel="prefetch" href="/assets/js/100.95a6c99c.js"><link rel="prefetch" href="/assets/js/101.b4a49f0b.js"><link rel="prefetch" href="/assets/js/102.2de85a2d.js"><link rel="prefetch" href="/assets/js/103.45e2e113.js"><link rel="prefetch" href="/assets/js/104.56158bd6.js"><link rel="prefetch" href="/assets/js/105.1f16775f.js"><link rel="prefetch" href="/assets/js/106.84151016.js"><link rel="prefetch" href="/assets/js/107.7b9fd16b.js"><link rel="prefetch" href="/assets/js/108.9a669853.js"><link rel="prefetch" href="/assets/js/109.607b8ba0.js"><link rel="prefetch" href="/assets/js/11.9a5b96b4.js"><link rel="prefetch" href="/assets/js/110.035ebd82.js"><link rel="prefetch" href="/assets/js/111.2189344f.js"><link rel="prefetch" href="/assets/js/112.acc94015.js"><link rel="prefetch" href="/assets/js/113.732292c6.js"><link rel="prefetch" href="/assets/js/114.69d6fa65.js"><link rel="prefetch" href="/assets/js/115.b01a3599.js"><link rel="prefetch" href="/assets/js/116.6724705b.js"><link rel="prefetch" href="/assets/js/117.ce49efe5.js"><link rel="prefetch" href="/assets/js/118.28357f19.js"><link rel="prefetch" href="/assets/js/119.183d08ed.js"><link rel="prefetch" href="/assets/js/12.44fb0008.js"><link rel="prefetch" href="/assets/js/120.474cdfad.js"><link rel="prefetch" href="/assets/js/121.e3ecdcc4.js"><link rel="prefetch" href="/assets/js/122.0a0bc0aa.js"><link rel="prefetch" href="/assets/js/123.0c6ab3ab.js"><link rel="prefetch" href="/assets/js/124.0d0ffb49.js"><link rel="prefetch" href="/assets/js/125.0e81a183.js"><link rel="prefetch" href="/assets/js/126.aad938f8.js"><link rel="prefetch" href="/assets/js/127.a0f92902.js"><link rel="prefetch" href="/assets/js/128.1d6192b0.js"><link rel="prefetch" href="/assets/js/129.b953e757.js"><link rel="prefetch" href="/assets/js/13.a330722e.js"><link rel="prefetch" href="/assets/js/130.7bb5e38e.js"><link rel="prefetch" href="/assets/js/131.7462b2ba.js"><link rel="prefetch" href="/assets/js/132.c0928987.js"><link rel="prefetch" href="/assets/js/133.198cb7db.js"><link rel="prefetch" href="/assets/js/134.297283a1.js"><link rel="prefetch" href="/assets/js/135.7f82baca.js"><link rel="prefetch" href="/assets/js/136.0c6b96f4.js"><link rel="prefetch" href="/assets/js/137.dae22f59.js"><link rel="prefetch" href="/assets/js/138.30641cf0.js"><link rel="prefetch" href="/assets/js/139.4153d23d.js"><link rel="prefetch" href="/assets/js/14.6847a39f.js"><link rel="prefetch" href="/assets/js/141.496ceb78.js"><link rel="prefetch" href="/assets/js/142.0de8f200.js"><link rel="prefetch" href="/assets/js/143.28d82825.js"><link rel="prefetch" href="/assets/js/144.acce788f.js"><link rel="prefetch" href="/assets/js/145.9cfb27d2.js"><link rel="prefetch" href="/assets/js/146.6230832c.js"><link rel="prefetch" href="/assets/js/147.121e1344.js"><link rel="prefetch" href="/assets/js/148.f0e26f06.js"><link rel="prefetch" href="/assets/js/149.dea71d53.js"><link rel="prefetch" href="/assets/js/15.0e030877.js"><link rel="prefetch" href="/assets/js/150.9ba2012f.js"><link rel="prefetch" href="/assets/js/151.59a8ddd9.js"><link rel="prefetch" href="/assets/js/152.1d937849.js"><link rel="prefetch" href="/assets/js/153.d9366ef7.js"><link rel="prefetch" href="/assets/js/154.9d104827.js"><link rel="prefetch" href="/assets/js/155.96d646cc.js"><link rel="prefetch" href="/assets/js/156.f87e7868.js"><link rel="prefetch" href="/assets/js/157.9fd3efa6.js"><link rel="prefetch" href="/assets/js/158.75948c6a.js"><link rel="prefetch" href="/assets/js/159.9b842781.js"><link rel="prefetch" href="/assets/js/16.74612e69.js"><link rel="prefetch" href="/assets/js/160.56221aa8.js"><link rel="prefetch" href="/assets/js/161.17b059f2.js"><link rel="prefetch" href="/assets/js/162.668f0874.js"><link rel="prefetch" href="/assets/js/163.b6b0e348.js"><link rel="prefetch" href="/assets/js/164.341c344d.js"><link rel="prefetch" href="/assets/js/165.c8c5e318.js"><link rel="prefetch" href="/assets/js/166.15c69481.js"><link rel="prefetch" href="/assets/js/167.0d5a35a6.js"><link rel="prefetch" href="/assets/js/168.169a4503.js"><link rel="prefetch" href="/assets/js/169.0918ad60.js"><link rel="prefetch" href="/assets/js/17.aff28c92.js"><link rel="prefetch" href="/assets/js/170.1f41cdee.js"><link rel="prefetch" href="/assets/js/171.32de0dd3.js"><link rel="prefetch" href="/assets/js/172.8d0977fa.js"><link rel="prefetch" href="/assets/js/173.7f833ed2.js"><link rel="prefetch" href="/assets/js/174.e3cf5acf.js"><link rel="prefetch" href="/assets/js/175.c5e1249f.js"><link rel="prefetch" href="/assets/js/176.36d2aed6.js"><link rel="prefetch" href="/assets/js/177.2b946f65.js"><link rel="prefetch" href="/assets/js/178.6471a14e.js"><link rel="prefetch" href="/assets/js/18.6c553fe2.js"><link rel="prefetch" href="/assets/js/19.25a79e40.js"><link rel="prefetch" href="/assets/js/20.2912c5fd.js"><link rel="prefetch" href="/assets/js/21.cc8f7cb4.js"><link rel="prefetch" href="/assets/js/22.73f5d0fb.js"><link rel="prefetch" href="/assets/js/23.082f826b.js"><link rel="prefetch" href="/assets/js/24.62a7a3fb.js"><link rel="prefetch" href="/assets/js/25.3f1ff6cb.js"><link rel="prefetch" href="/assets/js/26.02eb8e1c.js"><link rel="prefetch" href="/assets/js/27.c669fe7b.js"><link rel="prefetch" href="/assets/js/28.5c92c35c.js"><link rel="prefetch" href="/assets/js/29.5b037672.js"><link rel="prefetch" href="/assets/js/3.5e9c9aeb.js"><link rel="prefetch" href="/assets/js/30.503d0120.js"><link rel="prefetch" href="/assets/js/31.24297fec.js"><link rel="prefetch" href="/assets/js/32.96252ef0.js"><link rel="prefetch" href="/assets/js/33.c89e1ff8.js"><link rel="prefetch" href="/assets/js/34.d3ccb114.js"><link rel="prefetch" href="/assets/js/35.16c1381a.js"><link rel="prefetch" href="/assets/js/36.bf337c21.js"><link rel="prefetch" href="/assets/js/37.946363a7.js"><link rel="prefetch" href="/assets/js/38.97180054.js"><link rel="prefetch" href="/assets/js/39.db68880e.js"><link rel="prefetch" href="/assets/js/4.4290cd63.js"><link rel="prefetch" href="/assets/js/40.fdfa3edb.js"><link rel="prefetch" href="/assets/js/41.1364b864.js"><link rel="prefetch" href="/assets/js/42.b5fe6688.js"><link rel="prefetch" href="/assets/js/43.a657a0ea.js"><link rel="prefetch" href="/assets/js/44.c60c202e.js"><link rel="prefetch" href="/assets/js/45.f0ca7707.js"><link rel="prefetch" href="/assets/js/46.a2cfa915.js"><link rel="prefetch" href="/assets/js/47.00eaf68b.js"><link rel="prefetch" href="/assets/js/48.0697506a.js"><link rel="prefetch" href="/assets/js/49.d975a8c1.js"><link rel="prefetch" href="/assets/js/5.c8d737d0.js"><link rel="prefetch" href="/assets/js/50.d71495f8.js"><link rel="prefetch" href="/assets/js/51.45b983df.js"><link rel="prefetch" href="/assets/js/52.86cfff51.js"><link rel="prefetch" href="/assets/js/53.7aab1ca2.js"><link rel="prefetch" href="/assets/js/54.4d1b9288.js"><link rel="prefetch" href="/assets/js/55.5b50da92.js"><link rel="prefetch" href="/assets/js/56.2c9ea1c5.js"><link rel="prefetch" href="/assets/js/57.ed975abb.js"><link rel="prefetch" href="/assets/js/58.c103cc9b.js"><link rel="prefetch" href="/assets/js/59.aa73a8af.js"><link rel="prefetch" href="/assets/js/6.a41c5e20.js"><link rel="prefetch" href="/assets/js/60.12f2b692.js"><link rel="prefetch" href="/assets/js/61.83fae5c1.js"><link rel="prefetch" href="/assets/js/62.e31f6715.js"><link rel="prefetch" href="/assets/js/63.295992f4.js"><link rel="prefetch" href="/assets/js/64.2fc8a996.js"><link rel="prefetch" href="/assets/js/65.3d399173.js"><link rel="prefetch" href="/assets/js/66.aa557906.js"><link rel="prefetch" href="/assets/js/67.254bd65a.js"><link rel="prefetch" href="/assets/js/68.ad2097e4.js"><link rel="prefetch" href="/assets/js/69.b9231851.js"><link rel="prefetch" href="/assets/js/7.77d76dfa.js"><link rel="prefetch" href="/assets/js/70.49947637.js"><link rel="prefetch" href="/assets/js/71.d2610084.js"><link rel="prefetch" href="/assets/js/72.bff01f1e.js"><link rel="prefetch" href="/assets/js/73.3d9b6c19.js"><link rel="prefetch" href="/assets/js/74.a4201e96.js"><link rel="prefetch" href="/assets/js/75.8489c790.js"><link rel="prefetch" href="/assets/js/76.2f9bc769.js"><link rel="prefetch" href="/assets/js/77.ff492b54.js"><link rel="prefetch" href="/assets/js/78.31c6d8b2.js"><link rel="prefetch" href="/assets/js/79.21d03938.js"><link rel="prefetch" href="/assets/js/8.45e21c4e.js"><link rel="prefetch" href="/assets/js/80.0e9d328b.js"><link rel="prefetch" href="/assets/js/81.871bf4a7.js"><link rel="prefetch" href="/assets/js/82.e75460b6.js"><link rel="prefetch" href="/assets/js/83.e13d0013.js"><link rel="prefetch" href="/assets/js/84.8c34a475.js"><link rel="prefetch" href="/assets/js/85.e108fbd1.js"><link rel="prefetch" href="/assets/js/86.7d4ff604.js"><link rel="prefetch" href="/assets/js/87.53bc3752.js"><link rel="prefetch" href="/assets/js/88.a45401e3.js"><link rel="prefetch" href="/assets/js/89.b419f73b.js"><link rel="prefetch" href="/assets/js/9.c216597d.js"><link rel="prefetch" href="/assets/js/90.c7fe862e.js"><link rel="prefetch" href="/assets/js/91.ef3cfddd.js"><link rel="prefetch" href="/assets/js/92.721483d9.js"><link rel="prefetch" href="/assets/js/93.c070a2da.js"><link rel="prefetch" href="/assets/js/94.0295dc34.js"><link rel="prefetch" href="/assets/js/95.f327f220.js"><link rel="prefetch" href="/assets/js/96.922233b5.js"><link rel="prefetch" href="/assets/js/97.1c062e72.js"><link rel="prefetch" href="/assets/js/98.bc678e0d.js"><link rel="prefetch" href="/assets/js/99.40c68a6a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ded236f3.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="王清欢Randy" class="logo"> <span class="site-name can-hide">王清欢Randy</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程基础" class="dropdown-title"><a href="/pages/fa0f35/" class="link-title">编程基础</a> <span class="title" style="display:none;">编程基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>编程语言</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/bb810c/" class="nav-link">C/C++ 学习笔记</a></li><li class="dropdown-subitem"><a href="/pages/4b9df2/" class="nav-link">Golang 学习笔记</a></li></ul></li><li class="dropdown-item"><h4>算法分析</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/0f3851/" class="nav-link">LeetCode 刷题笔记</a></li></ul></li><li class="dropdown-item"><h4>操作系统</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/bcf4de/" class="nav-link">Linux 基础</a></li><li class="dropdown-subitem"><a href="/pages/875f14/" class="nav-link">Vim 实用技巧</a></li><li class="dropdown-subitem"><a href="/pages/028d7e/" class="nav-link">Shell 脚本编程</a></li><li class="dropdown-subitem"><a href="/pages/f4281d/" class="nav-link">GDB 学习笔记</a></li></ul></li><li class="dropdown-item"><h4>开发工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8292d8/" class="nav-link">Git 学习笔记</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="理论知识" class="dropdown-title"><a href="/pages/240fd4/" class="link-title">理论知识</a> <span class="title" style="display:none;">理论知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>分布式理论</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/2f33c0/404" class="nav-link">共识算法</a></li><li class="dropdown-subitem"><a href="/pages/2f33c0/404" class="nav-link">分布式事务</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开源实践" class="dropdown-title"><a href="/pages/93824d/" class="link-title">开源实践</a> <span class="title" style="display:none;">开源实践</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>数据库内核</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/2f33c0/404" class="nav-link">PostgreSQL</a></li><li class="dropdown-subitem"><a href="/pages/2f33c0/404" class="nav-link">Postgres-XL</a></li></ul></li><li class="dropdown-item"><!----> <a href="/pages/2f33c0/404" class="nav-link">hidb</a></li><li class="dropdown-item"><!----> <a href="/pages/2f33c0/404" class="nav-link">pgproxy</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="胡思乱想" class="dropdown-title"><a href="/pages/0232db/" class="link-title">胡思乱想</a> <span class="title" style="display:none;">胡思乱想</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习方法</a></li><li class="dropdown-item"><!----> <a href="/pages/35750f/" class="nav-link">资源分享</a></li></ul></div></div> <a href="https://github.com/wang-haihua/TechStack" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程基础" class="dropdown-title"><a href="/pages/fa0f35/" class="link-title">编程基础</a> <span class="title" style="display:none;">编程基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>编程语言</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/bb810c/" class="nav-link">C/C++ 学习笔记</a></li><li class="dropdown-subitem"><a href="/pages/4b9df2/" class="nav-link">Golang 学习笔记</a></li></ul></li><li class="dropdown-item"><h4>算法分析</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/0f3851/" class="nav-link">LeetCode 刷题笔记</a></li></ul></li><li class="dropdown-item"><h4>操作系统</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/bcf4de/" class="nav-link">Linux 基础</a></li><li class="dropdown-subitem"><a href="/pages/875f14/" class="nav-link">Vim 实用技巧</a></li><li class="dropdown-subitem"><a href="/pages/028d7e/" class="nav-link">Shell 脚本编程</a></li><li class="dropdown-subitem"><a href="/pages/f4281d/" class="nav-link">GDB 学习笔记</a></li></ul></li><li class="dropdown-item"><h4>开发工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8292d8/" class="nav-link">Git 学习笔记</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="理论知识" class="dropdown-title"><a href="/pages/240fd4/" class="link-title">理论知识</a> <span class="title" style="display:none;">理论知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>分布式理论</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/2f33c0/404" class="nav-link">共识算法</a></li><li class="dropdown-subitem"><a href="/pages/2f33c0/404" class="nav-link">分布式事务</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开源实践" class="dropdown-title"><a href="/pages/93824d/" class="link-title">开源实践</a> <span class="title" style="display:none;">开源实践</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>数据库内核</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/2f33c0/404" class="nav-link">PostgreSQL</a></li><li class="dropdown-subitem"><a href="/pages/2f33c0/404" class="nav-link">Postgres-XL</a></li></ul></li><li class="dropdown-item"><!----> <a href="/pages/2f33c0/404" class="nav-link">hidb</a></li><li class="dropdown-item"><!----> <a href="/pages/2f33c0/404" class="nav-link">pgproxy</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="胡思乱想" class="dropdown-title"><a href="/pages/0232db/" class="link-title">胡思乱想</a> <span class="title" style="display:none;">胡思乱想</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习方法</a></li><li class="dropdown-item"><!----> <a href="/pages/35750f/" class="nav-link">资源分享</a></li></ul></div></div> <a href="https://github.com/wang-haihua/TechStack" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Linux 基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/bcf4de/" class="sidebar-link">基本Linux命令</a></li><li><a href="/pages/f56384/" class="sidebar-link">文件与目录操作</a></li><li><a href="/pages/0b3143/" class="sidebar-link">进程与线程</a></li><li><a href="/pages/ff5e65/" class="sidebar-link">线程同步与进程通信</a></li><li><a href="/pages/5d33e8/" class="sidebar-link">Linux 文件权限</a></li><li><a href="/pages/154d65/" class="sidebar-link">Linux 命令行快捷键</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vim 实用技巧</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/875f14/" class="sidebar-link">Vim常用技巧</a></li><li><a href="/pages/dfff1a/" class="sidebar-link">Vim解决问题的方式</a></li><li><a href="/pages/7fbd14/" class="sidebar-link">Vim普通模式</a></li><li><a href="/pages/aab584/" class="sidebar-link">Vim插入模式</a></li><li><a href="/pages/2a0740/" class="sidebar-link">Vim可视模式</a></li><li><a href="/pages/d598a0/" class="sidebar-link">Vim命令行模式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Shell 脚本编程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/028d7e/" class="sidebar-link">目录</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>GDB学习笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/f4281d/" class="sidebar-link">GDB基础调试</a></li><li><a href="/pages/2f33c0/" aria-current="page" class="active sidebar-link">GDB调试Coredump</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/2f33c0/#_01-什么是-coredump" class="sidebar-link">01 什么是 coredump</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/2f33c0/#_1-1-ulimit-命令" class="sidebar-link">1.1 ulimit 命令</a></li><li class="sidebar-sub-header level3"><a href="/pages/2f33c0/#_1-2-coredump-实例" class="sidebar-link">1.2 coredump 实例</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/2f33c0/#_02-coredump-是怎么发生的" class="sidebar-link">02 coredump 是怎么发生的</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/2f33c0/#_2-1-程序运行错误导致-coredump" class="sidebar-link">2.1 程序运行错误导致 coredump</a></li><li class="sidebar-sub-header level3"><a href="/pages/2f33c0/#_2-2-coredump-文件生成原理" class="sidebar-link">2.2 coredump 文件生成原理</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/2f33c0/#参考资料" class="sidebar-link">参考资料</a></li></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>Linux操作系统编程</span></li><li data-v-06225672><span data-v-06225672>GDB学习笔记</span></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/wang-haihua" target="_blank" title="作者" class="beLink" data-v-06225672>王清欢</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-11-18</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">GDB调试Coredump<!----></h1> <!----> <div class="theme-vdoing-content content__default"><p>在计算机系统中运行程序时，问题经常发生，而且通常很难找到根源。幸运的是，有一种叫做 coredump 的文件可以帮助我们找到问题的源头。本文将解释什么是 coredump，它是如何工作的，以及如何利用它来定位问题。</p> <h2 id="_01-什么是-coredump"><a href="#_01-什么是-coredump" class="header-anchor">#</a> 01 什么是 coredump</h2> <hr> <p>Core dump（核心转储）是指在程序运行过程中发生错误或异常时，操作系统将程序的内存内容保存到磁盘上的一种文件。这个文件包含了程序崩溃时的内存状态，包括变量的值、函数调用栈、寄存器状态等信息。通过分析 coredump 文件，可以了解程序崩溃的原因，以便进行调试和修复。</p> <h3 id="_1-1-ulimit-命令"><a href="#_1-1-ulimit-命令" class="header-anchor">#</a> 1.1 ulimit 命令</h3> <p>要生成 core dump 文件，通常需要在操作系统中设置相应的配置。在 Linux 和 Unix 系统中，可以使用 ulimit 命令设置 core dump 文件的大小限制，并使用 gcore 或 kill -SIGQUIT 命令生成 core dump 文件。</p> <p><code>ulimit</code> 是 Unix 和 Linux 系统中的内置命令，用于控制用户级别的系统资源限制。这些资源包括文件大小、进程数、核心文件大小、堆栈大小等等。以下是一些使用 ulimit 的基础知识。</p> <p>使用 <code>ulimit -a</code> 可以列出所有的限制，每一行都对应一个资源类型和其对应的限制。
以下是一些比较常用的 ulimit 选项：</p> <ul><li><code>ulimit -u</code> : 查看用户可以用的最大进程数。</li> <li><code>ulimit -n</code> : 文件描述符的最大个数，即一个进程可以同时打开的最大文件数。</li> <li><code>ulimit -d</code> : 一个进程可以使用的最大数据段大小，单位为KB。</li> <li><code>ulimit -s</code> : 最大堆栈大小，单位为KB。</li> <li><code>ulimit -c</code> : 生成coredump文件的最大大小，单位为KB。</li> <li><code>ulimit -v</code> : 进程虚拟内存的最大值，单位KB。</li></ul> <p>我们可以在命令后添加具体的数值来设置对应的资源限制，例如：</p> <ul><li><code>ulimit -n 1024</code> : 设置最大可以打开的文件描述符数为1024。</li> <li><code>ulimit -c unlimited</code> : 设置coredump的大小为无限。</li></ul> <p>需要注意的是，ulimit 命令设置的资源限制是以 Shell 环境为单位的，而不是全局性的。也就是说，在一个 Shell 环境中设置的资源限制，并不会影响到其他的 Shell 环境。同时，这些限制只对当前 Shell 环境以及它派生出来的子进程生效，对已经存在的其他进程没有影响。</p> <p>总的来说，ulimit 命令是一个很有用的工具，它可以帮助我们控制进程对系统资源的使用，从而防止一些程序错误导致系统资源的耗尽。
3</p> <h3 id="_1-2-coredump-实例"><a href="#_1-2-coredump-实例" class="header-anchor">#</a> 1.2 coredump 实例</h3> <p><strong>1. ulimit 查看资源限制</strong></p> <p>一般情况下如果 coredump 文件没有生成，很大可能是由于受到资源限制，使用 ulimit命令查看和设置资源限制</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">ulimit</span> <span class="token parameter variable">-c</span>						 <span class="token comment"># 查看是否开启 core，0 表示关闭 </span>
<span class="token builtin class-name">ulimit</span> <span class="token parameter variable">-c</span> <span class="token punctuation">[</span>filesize<span class="token punctuation">]</span> <span class="token comment"># 设置 core 文件大小</span>
<span class="token builtin class-name">ulimit</span> <span class="token parameter variable">-c</span> unlimited  <span class="token comment"># 设置 core 文件大小为无限</span>
</code></pre></div><p><strong>2. 设置 core 文件路径</strong></p> <p>在 Linux 系统中，core dump 文件的路径是由 <code>/proc/sys/kernel/core_pattern</code> 定义的，如果这个文件不存在，或者内容为空，那么 core dump 文件就会生成在当前目录下</p> <p>也可以通过修改 <code>/proc/sys/kernel/core_pattern</code> 指定 core 文件生成的路径和文件名</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 查看当前 core 文件路径</span>
<span class="token function">cat</span> /proc/sys/kernel/core_pattern 

<span class="token comment"># 指定 core 文件路径</span>
<span class="token function">sudo</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;yourpath/core.%e.%p.%h.%t&quot;</span> <span class="token operator">&gt;</span> /proc/sys/kernel/core_pattern
<span class="token function">sudo</span> <span class="token function">sysctl</span> <span class="token parameter variable">-w</span> <span class="token assign-left variable">kernel.core_pattern</span><span class="token operator">=</span>yourpath/core.%e.%p.%h.%t  <span class="token comment"># # 也可以使用 sysctl 修改 kernel.core_pattern 来指定 core 文件路径</span>
</code></pre></div><p>其中 core 文件名称定义中，可以使用占位符保留一些有用信息</p> <div class="language-bash extra-class"><pre class="language-bash"><code>%p: pid
%u: uid
%g: gid
%s: signal number
%t: UNIX <span class="token function">time</span> of dump
%h: <span class="token function">hostname</span>
%e: executable filename
</code></pre></div><p><strong>3. 空指针 core 示例</strong></p> <p>下面这个例子中试图通过一个 NULL 指针来访问内存，这是非法的，因为 NULL 指针并没有指向任何有效的内存位置，因而在运行时，操作系统将识别这个非法操作，并生成一个 Coredump 文件。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> <span class="token operator">*</span>ptr <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d&quot;</span><span class="token punctuation">,</span> <span class="token operator">*</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>编译运行这段程序如下，可以看到触发了 core dumped</p> <p>需要注意的是编译的时候记得加上 <code>-g</code> 参数保留调试信息，否则使用 GDB 调试时会找不到函数名或者变量名</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ gcc <span class="token parameter variable">-g</span> main.c <span class="token parameter variable">-o</span> main
$ ./main
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token number">277</span> segmentation fault <span class="token punctuation">(</span>core dumped<span class="token punctuation">)</span>  ./main
</code></pre></div><p><strong>4. 使用 GDB 调试 core 文件</strong></p> <p>找到 core 文件，然后使用命令 <code>gdb [exec file] [core file]</code> 调试 core 文件</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token builtin class-name">cd</span> your-core-path
$ <span class="token function">ls</span>
core.main
$ gdb ~/main ./core.main
</code></pre></div><p>GDB 运行后会停止在发生异常的代码处，并且将发生异常的代码打印出来，如下图中指出了异常位于 mian.c 的第 5 行代码 <code>*ptr</code> 是一个空指针</p> <img src="https://img-blog.csdnimg.cn/5459a44df5f9448aa7eb35507df96d40.png#pic_center" alt="pic" style="zoom:50%;"> <h2 id="_02-coredump-是怎么发生的"><a href="#_02-coredump-是怎么发生的" class="header-anchor">#</a> 02 coredump 是怎么发生的</h2> <hr> <h3 id="_2-1-程序运行错误导致-coredump"><a href="#_2-1-程序运行错误导致-coredump" class="header-anchor">#</a> 2.1 程序运行错误导致 coredump</h3> <p>程序执行非法操作时，例如解引用空指针，除数为零，或者访问越界的内存，操作系统就会生成一个 coredump 文件并终止程序运行。以下是一些常见导致 core dump 发生的原因：</p> <ul><li>空指针引用：当程序试图访问一个空指针时，操作系统会捕获这个错误并生成 core dump 文件</li> <li>内存越界：当程序试图访问超出其分配内存范围的位置时，可能会导致内存越界错误，从而触发 core dump</li> <li>栈溢出：当程序的函数调用栈超过其允许的最大深度时，可能会发生栈溢出错误，导致 core dump 发生</li> <li>除零错误：当程序试图除以零时，会触发除零错误，操作系统可能会生成 core dump 文件</li> <li>非法指令：当程序执行了无效或非法的机器指令时，操作系统通常会生成 core dump 文件</li> <li>内存分配错误：当程序遇到内存分配错误，如申请内存失败或释放已释放的内存时，可能会触发 core dump</li></ul> <p>这些程序执行非法操作时，操作系统会向指定进程发送特定信号（signal）终止程序运行并生成 coredump，一些常见信号有：</p> <ul><li>SIGSEGV (信号值 11)：当一个进程由于无效的内存访问，如解引用空指针，或访问受保护的内存区域时，系统会向它发送此信号。这是生成coredump最常见的原因</li> <li>SIGABRT (信号值 6)：当进程自身检测到一个无法恢复的问题，并选择主动终止时，它会发送这个信号给自己。例如，C库函数abort()就会发送这个信号</li> <li>SIGILL (信号值 4)：当CPU检测到进程试图执行一条无效或未定义的指令时，系统会发送此信号。一个可能的原因是代码的内存被错误地当作数据修改</li> <li>SIGFPE (信号值 8)：在数学运算错误时发送，比如除以零或浮点溢出</li> <li>SIGBUS (信号值 7)：用于处理错误的内存访问，但这个信号在不同的系统和架构下含义可能会有所不同。在某些系统中，它用于处理对齐（alignment）问题</li> <li>SIGQUIT (信号值 3)：用户通过控制台（通常是按Ctrl+\）向进程发送此信号，它不仅会停止进程的运行，还会生成coredump</li></ul> <table><thead><tr><th>Signal</th> <th>Value</th> <th>Action</th> <th>Comment</th></tr></thead> <tbody><tr><td>SIGSEGV</td> <td>11</td> <td>Core</td> <td>Invalid memory reference</td></tr> <tr><td>SIGABRT</td> <td>6</td> <td>Core</td> <td>Abort signal from abort</td></tr> <tr><td>SIGILL</td> <td>4</td> <td>Core</td> <td>Illegal Instruction</td></tr> <tr><td>SIGFPE</td> <td>8</td> <td>Core</td> <td>Floating point exception</td></tr> <tr><td>SIGBUS</td> <td>7</td> <td>Core</td> <td>Bus error (bad memory access)</td></tr> <tr><td>SIGQUIT</td> <td>3</td> <td>Core</td> <td>Quit from keyboard</td></tr></tbody></table> <h3 id="_2-2-coredump-文件生成原理"><a href="#_2-2-coredump-文件生成原理" class="header-anchor">#</a> 2.2 coredump 文件生成原理</h3> <blockquote><p>本节参考如有侵权，请告知：https://cloud.tencent.com/developer/article/1860631</p></blockquote> <p>coredump 文件的产生过程如下图所示：</p> <p>Linux 内核实现中使用一个复杂的任务结构（task_struct）结构体来代表系统中的每个进程或线程，这个结构体被定义在 <code>include/linux/sched.h</code> 文件中，其中也包含了记录信号处理相关的属性，如用于存放待处理信号的 pending 信号队列和阻塞信号 blocked 等。</p> <p>当一个信号被发送到进程时，它首先被添加到该进程的 pending 信号队列中。而内核在进程切换的上下文切换中，在运行被调用进程时会先检查这个 pending 信号队列。如果有待处理的信号，内核会在恢复进程运行前，调用信号的处理函数。这个过程大多数发生在 <code>do_signal</code> 函数中，这个函数在每次中断返回，系统调用返回，或者任何可能会改变进程状态的操作后执行。</p> <p>如果一个信号是致命的（如 SIGSEGV, SIGABRT），并且进程并没有注册处理函数来处理它，那么内核会根据这个信号的默认行为来操作，比如可能会终止进程，或者产生 coredump 文件等。
<img src="https://img-blog.csdnimg.cn/49403a93fefb43e885cf7e9bdf0aa617.png#pic_center" alt="在这里插入图片描述">
通过上述分析，coredump 文件生成的过程可以总结为：程序运行产生 core 相关的信号 signal；do_signal 函数处理信号；如果默认行为是 Core 则调用 do_coredump 函数生成 core 文件。下面结合源码进一步分析该过程</p> <p><strong>1. 信号处理过程</strong></p> <p>在进程切换的上下文切换时，检查信号队列 pending 是否有待处理信号，有则调用 do_singal 函数处理，该函数中使用 <code>get_signal_to_deliver</code> 函数从进程的信号队列 pending 中获取一个信号，然后根据信号的类型来进行不同的操作。</p> <p><code>get_signal_to_deliver</code> 函数中处理 coredump 相关信号的代码实现如下，首先使用 <code>dequeue_signal</code> 函数获取信号，然后使用 <code>sig_kernel_coredump</code> 函数判断该信号是否为 coredump 相关信号，如果是则执行 core 相关动作</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">get_signal_to_deliver</span><span class="token punctuation">(</span><span class="token class-name">siginfo_t</span> <span class="token operator">*</span>info<span class="token punctuation">,</span> <span class="token keyword">struct</span> <span class="token class-name">k_sigaction</span> <span class="token operator">*</span>return_ka<span class="token punctuation">,</span>
                          <span class="token keyword">struct</span> <span class="token class-name">pt_regs</span> <span class="token operator">*</span>regs<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>cookie<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">sigset_t</span> <span class="token operator">*</span>mask <span class="token operator">=</span> <span class="token operator">&amp;</span>current<span class="token operator">-&gt;</span>blocked<span class="token punctuation">;</span>
    <span class="token keyword">int</span> signr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token comment">// 1. 从进程信号队列中获取一个信号</span>
        signr <span class="token operator">=</span> <span class="token function">dequeue_signal</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> mask<span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">;</span> 

        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token comment">// 2. 判断是否会生成 coredump 文件的信号</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sig_kernel_coredump</span><span class="token punctuation">(</span>signr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 3. 调用 do_coredump() 函数生成 coredump 文件</span>
            <span class="token function">do_coredump</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>signr<span class="token punctuation">,</span> signr<span class="token punctuation">,</span> regs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>2. 生成 coredump 文件</strong></p> <p>当 coredump 相关信号被处理时，调用内核就会调用 <code>do_coredump</code> 函数来生成 coredump 文件，该函数核心代码如下，首先判断 ulimit 的资源限制情况，如果可用则创建 coredump 文件，最后将当前进程的寄存器、内存管理等相关信息写入到该文件中。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">do_coredump</span><span class="token punctuation">(</span><span class="token keyword">long</span> signr<span class="token punctuation">,</span> <span class="token keyword">int</span> exit_code<span class="token punctuation">,</span> <span class="token keyword">struct</span> <span class="token class-name">pt_regs</span> <span class="token operator">*</span>regs<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">char</span> corename<span class="token punctuation">[</span>CORENAME_MAX_SIZE <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">mm_struct</span> <span class="token operator">*</span>mm <span class="token operator">=</span> current<span class="token operator">-&gt;</span>mm<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">linux_binfmt</span> <span class="token operator">*</span>binfmt<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">inode</span> <span class="token operator">*</span>inode<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">file</span> <span class="token operator">*</span>file<span class="token punctuation">;</span>
    <span class="token keyword">int</span> retval <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> fsuid <span class="token operator">=</span> current<span class="token operator">-&gt;</span>fsuid<span class="token punctuation">;</span>
    <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> ispipe <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    binfmt <span class="token operator">=</span> current<span class="token operator">-&gt;</span>binfmt<span class="token punctuation">;</span> <span class="token comment">// 当前进程所使用的可执行文件格式（如ELF格式）</span>

    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token comment">// 1. 判断当前进程可生成的 coredump 文件大小是否受到资源限制</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>current<span class="token operator">-&gt;</span>signal<span class="token operator">-&gt;</span>rlim<span class="token punctuation">[</span>RLIMIT_CORE<span class="token punctuation">]</span><span class="token punctuation">.</span>rlim_cur <span class="token operator">&lt;</span> binfmt<span class="token operator">-&gt;</span>min_coredump<span class="token punctuation">)</span>
        <span class="token keyword">goto</span> fail_unlock<span class="token punctuation">;</span>

    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token comment">// 2. 生成 coredump 文件名</span>
    ispipe <span class="token operator">=</span> <span class="token function">format_corename</span><span class="token punctuation">(</span>corename<span class="token punctuation">,</span> core_pattern<span class="token punctuation">,</span> signr<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token comment">// 3. 创建 coredump 文件</span>
    file <span class="token operator">=</span> <span class="token function">filp_open</span><span class="token punctuation">(</span>corename<span class="token punctuation">,</span> O_CREAT<span class="token operator">|</span><span class="token number">2</span><span class="token operator">|</span>O_NOFOLLOW<span class="token operator">|</span>O_LARGEFILE<span class="token operator">|</span>flag<span class="token punctuation">,</span> <span class="token number">0600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token comment">// 4. 把进程的内存信息写入到 coredump 文件中</span>
    retval <span class="token operator">=</span> binfmt<span class="token operator">-&gt;</span><span class="token function">core_dump</span><span class="token punctuation">(</span>signr<span class="token punctuation">,</span> regs<span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>

fail_unlock<span class="token operator">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">return</span> retval<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <p><a href="https://cloud.tencent.com/developer/article/1860631" target="_blank" rel="noopener noreferrer">一文读懂 | coredump文件是如何生成的-腾讯云开发者社区-腾讯云<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://zhuanlan.zhihu.com/p/636765151" target="_blank" rel="noopener noreferrer">core dump 路径定义以及监控<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://developer.aliyun.com/article/1133857#:~:text=3.%E8%B0%83%E8%AF%95core%E6%96%87%E4%BB%B6%20%EF%BC%881%EF%BC%89%E6%96%B9%E6%B3%951%3A%20gdb%20%5Bexec%20file%5D%20%5Bcore%20file%5D%20%E7%84%B6%E5%90%8E%E6%89%A7%E8%A1%8Cbt%E7%9C%8B%E5%A0%86%E6%A0%88%E4%BF%A1%E6%81%AF%EF%BC%9A,-c%20%5Bcore%20file%5D%2C%E7%84%B6%E5%90%8E%20file%20%5Bexec%20file%5D%2C%E6%9C%80%E5%90%8E%E5%86%8D%E4%BD%BF%E7%94%A8%20bt%20%E6%9F%A5%E7%9C%8B%E9%94%99%E8%AF%AF%E4%BD%8D%E7%BD%AE%EF%BC%9A" target="_blank" rel="noopener noreferrer">Linux下gdb调试生成core文件并调试core文件-阿里云开发者社区<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://zhuanlan.zhihu.com/p/112970875" target="_blank" rel="noopener noreferrer">Linux进程描述符task_struct结构体详解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://zhuanlan.zhihu.com/p/46605905" target="_blank" rel="noopener noreferrer">gdb调试coredump（使用篇）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/11/19, 12:55:48</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/f4281d/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">GDB基础调试</div></a> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/f4281d/" class="prev">GDB基础调试</a></span> <!----></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:wanghaihua@hust.edu.cn" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/wang-haihua" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://randy.blog.csdn.net/" title="CSDN" target="_blank" class="iconfont icon-csdn"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2024
    <span>Wang Qinghuan | MIT License</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.3c964c09.js" defer></script><script src="/assets/js/2.7cb4c100.js" defer></script><script src="/assets/js/140.c25d78fc.js" defer></script>
  </body>
</html>
